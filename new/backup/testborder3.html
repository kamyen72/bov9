<!DOCTYPE html>
<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

  <!-- Include Moment.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

  <!-- Include Bootstrap DateTimePicker CDN -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>

  <style>
    @media ( max-width: 240px)
    {  #myDIVx { width:90%; }      
    }

    body {
      background-color:#E7E9EB;
      font-family: Helvetica;
      font-size: 12px;
    }

    td {
      font-family: Helvetica;
    }


    #ShowTimeButt{
      border-radius: 10px;
    }

    #menuDiv {
      position: absolute;
      top: 0px;
      left: 0px;
      width: 320px;
      display: none;
      opacity: 0;
      background-color:#007E9F;
      border: 1px solid none;
      border-radius:0px 0px 0px 0px;
      padding-left: 0px;
      padding-bottom:0px;
      padding-top:0px;
      color:#ffffff;
      font-size:18px;
      font-weight: normal;
      font-family: Helvetica;
    }

    #myDIVx {
      position: absolute;
      height:35px;
      left:5px;
      top:150px;
      margin-left:5px;
/*      min-width: 363px;*/
      background-color:#007E9F;
      border: 1px solid none;
      border-radius:10px 10px 0px 0px;
      padding-left: 10px;
      padding-bottom:0px;
      padding-top:10px;
      color:#ffffff;
      font-size:15px;
      font-weight: 100;
      font-family: Arial Black;
      display: inline-block;
      cursor: pointer;
      border-color: blue;
      border-width: 1px;
    }

    #mySearchElements {
      position: absolute;
      height:250px;
      left:5px;
      top:185px;
      margin-left:5px;
      min-width: 317px;
      background-color:#ffffff;
      border: 1px solid none;
      border-radius:0px 0px 0px 0px;
      padding-left: 10px;
      padding-bottom:0px;
      padding-top: 10px;
      font-size:12px;
      font-weight: normal;
      font-family: Helvetica;
      display: inline-block;
      border-color: blue;
      border-width: 1px;
    }


    #myButtons {
      position: absolute;
      height:95px;
      left:281px;
      top:0px;
      margin-left:75px;width: 80%;
      padding-left: 10px;
      padding-bottom:20px;
      padding-top:75px;
      font-size:11px;
      font-weight: normal;
      font-family: Helvetica;
      display: none;
      cursor: pointer;
    }

    .buttspan {
      border-radius: 20px;
      background-color: #ffffff;
      padding: 10px 20px 10px 19px;
    }

    .activeButt {
      background-color: #007E9F;
      color:#ffffff;
    }


    .mylabel {
      color: #000000;
      font-size: 14px;
    }

    .datebox {
    }

    .btnOverall {
      width: 25px;
      height: 25px;
    }

    #btnOverall {
      position: relative;
      top: 6px;
      width: 25px;
      height: 25px;
      display: inline-block;
    }

    #dtDateS {color: #000000;}
    #dtDateE {color: #000000;}

    .imglink {
      position: relative;
      width: 25px;
      height: 25px;
      display: inline-block;
    }

    .imgbutton {
      width: 20px;
      height: 20px;
      position: relative;
      top: 3px;
    }

    .daterange {
      position: relative;
      top: 0px;
      display: inline-block;
      color: gray;
      border-style: solid;
      border-width: 1px;
      border-color: darkgray;
      border-radius: 20px;
      background-color: #ffffff;
      padding: 5px 10px 5px 10px;
      font-size: 10px;
      cursor: pointer;
    }

    .searchButton {
      position: relative;
      top: 0px;
      display: inline-block;
      color: #ffffff;
      border-style: solid;
      border-width: 1px;
      border-color: darkgray;
      border-radius: 20px;
      background-color: #007E9F;
      padding: 5px 10px 5px 10px;
      font-size: 10px;
      cursor: pointer;
    }

    .curlyborder {
      border-radius: 5px;
    }

    #selected_ticketx {
      width: 180px;
      color: black;
      border-style: solid;
      border-radius: 5px;
    }

    #selected_accountx {
      width: 180px;
      color: black;
      border-style: solid;
      border-radius: 5px;      
    }

    #selected_BetTypex {
      width: 180px;
      color: black;
      border-style: solid;
      border-radius: 5px;      
    }

    #btnOverall { cursor: pointer; }
    #btnTicket { cursor: pointer; }
    #btnAccounts { cursor: pointer; }
    #btnBetTypes { cursor: pointer; }

    .burger {
      position: fixed;
      left:320px;
      top:50px;
      width: 23px;
      height: 23px;
      padding: 7px 7px 7px 7px;
      background-color: #007E9F;
      border-radius:0px 5px 5px 0px;
      cursor: pointer;
      display: none;
    }

    #copyright2 {
      color: #926800;
      padding: 0;
      display: block;
      position: absolute;
      top: 820px;
      left:15px;
      text-align:center;
      font-size: 12px;
    }

    #footer .copyright {
      display: none;
    }

    .col {
      display: none;
    }

    #CheckingArea {
      position: absolute;
      top: 180px;
      height: 20%;
      width:80%;
      left: 5px;
      margin-left: 83px;
      background: blue;
      display: none;

    }

    #browsertype {
      display: none;
    }

    #L1Area {
      position: absolute;
      top: 110px;
      left: 0px;
      margin-left: 15px;
      display: inline-block;
      padding-left: 5px;
      overflow: scroll;

    }

    #L2Area {
      position: absolute;
      top: 110px;
      
      left: 0px;
      margin-left: 15px;
      display: inline-block;
      padding-left: 5px;
      overflow: scroll;
    }

    #L3Area {
      position: absolute;
      top: 110px;
      left: 0px;
      margin-left: 15px;
      display: inline-block;
      padding-left: 5px;
      overflow: scroll;
    }

    #L4Area {
      position: absolute;
      top: 110px;
      left: 0px;
      margin-left: 15px;
      display: inline-block;
      padding-left: 5px;
      overflow: scroll;
    }

    #closebutton2 {
      position: absolute;
      top: 90px;
      border-radius: 10px;
      left: 1500px;
      display: inline-block;
      width: 25px;
      height: 25px;
      padding-left: 0px;
      padding-right: 0px;
      padding-top: 0px;
      padding-bottom: 0px;
      border: 1px solid;
      padding: 0px;
      box-shadow: 3px 2px #888888;
      border-radius:15px;  
      cursor: pointer; 
    }

    #copybutton2 {
      position: absolute;
      top: 118px;
      border-radius: 10px;
      left: 1500px;
      display: inline-block;
      width: 25px;
      height: 25px;
      padding-left: 0px;
      padding-right: 0px;
      padding-top: 0px;
      padding-bottom: 0px;
      border: 1px solid;
      padding: 0px;
      box-shadow: 3px 2px #888888;
      border-radius:15px;   
      cursor: pointer;       
    }

    #printbutton2 {
      position: absolute;
      top: 146px;
      border-radius: 10px;
      left: 1500px;
      display: inline-block;
      width: 25px;
      height: 25px;
      padding-left: 0px;
      padding-right: 0px;
      padding-top: 0px;
      padding-bottom: 0px;      
      border-style: none;
      border: 1px solid;
      padding: 0px;
      box-shadow: 3px 2px #888888;
      border-radius:15px;       
      cursor: pointer;       
    }

    #excelbutton2 {
      position: absolute;
      top: 174px;
      border-radius: 10px;
      left: 1500px;
      display: inline-block;
      width: 25px;
      height: 25px;
      padding-left: 0px;
      padding-right: 0px;
      padding-top: 0px;
      padding-bottom: 0px;      
      border-style: none;
      border: 1px solid;
      padding: 0px;
      box-shadow: 3px 2px #888888;
      border-radius:15px;   
      cursor: pointer; 
    }

    #downloadbutton2 {
      position: absolute;
      top: 202px;
      border-radius: 10px;
      left: 1500px;
      display: inline-block;
      width: 25px;
      height: 25px;
      padding-left: 10px;
      padding-right: 0px;
      padding-top: 15px;
      padding-bottom: 0px;  
      border-style: none;
      border: 1px solid;
      padding: 0px;
      box-shadow: 3px 2px #888888;
      border-radius:15px;   
      cursor: pointer; 
      text-align: center;          
    }

    #prevbutton2 {
      position: absolute;
      top: 230px;
      border-radius: 10px;
      left: 1500px;
      display: inline-block;
      width: 25px;
      height: 25px;
      padding-left: 0px;
      padding-right: 0px;
      padding-top: 0px;
      padding-bottom: 0px;
      border-style: none;
      border: 1px solid;
      padding: 0px;
      box-shadow: 3px 2px #888888;
      border-radius:15px;     
      cursor: pointer;         
    }

    .TableTitle {
      background: #0099FF;
    }

    .TableBack {background: #CCFFFF}

    .cellborder {
        font-family: Montserrat,'Noto Sans TC','Microsoft JhengHei',Arial,Helvetica,sans-serif;
        font-weight: 900;
        font-size: 11px;
        border-style: solid;
        border-width: 1px;
        border-color: #ebe9e9;
        background: #007E9F;
        color: #ffffff;
        padding-left: 6px;
        padding-right: 3px;
        padding-top: 5px;
        padding-bottom: 5px;
    }

    .celldata {
        color: #333;
        border-style: solid;
        border-width: 1px;
        border-color: #ebe9e9;
        background: #ffffff;
        padding-left: 6px;
        padding-right: 3px;
        padding-top: 5px;
        padding-bottom: 5px;
        font-family: Montserrat,'Noto Sans TC','Microsoft JhengHei',Arial,Helvetica,sans-serif;
        font-weight: 900;
        font-size: 11px;
    }

    .cellcenter {
        text-align: center;
    }

    .cellright {
        text-align: right;
    }

    .cellleft {
        text-align: left;
    }

    .bckPink {
        background: #f863ba;
        border-style: none;
    }

    .cellgrey {
      background-color: #ebe9e9;
      border-style: solid;
      border-width: 1px;
      border-color: #ebe9e9;
      padding-left: 6px;
      padding-right: 3px;
      padding-top: 5px;
      padding-bottom: 5px;
      font-family: Montserrat,'Noto Sans TC','Microsoft JhengHei',Arial,Helvetica,sans-serif;
      font-weight: 900;
      font-size: 11px;
    }

    .sumcell {
      color: #333;
      border-style: solid;
      border-width: 1px;
      border-color: #ebe9e9;
      padding-left: 6px;
      padding-right: 3px;
      padding-top: 5px;
      padding-bottom: 5px;
      font-family: 'Arial Black';
      font-weight: 900;
      font-size: 11px;
    }

    .bckPeal {
        color: #1888af;
        border-style: none;
        cursor: pointer;
        font-family: 'Arial Black';
        font-weight: 300;
        font-size: 10px;
    }

    .Report2 {
        background: #ffffff;
        border-style: solid;
        border-width: 4px;
        border-radius: 5px;
        border-color: darkgreen;
    }

    .isnegative {
      color: red;
      font-weight: bolder;
      border-style: solid;
      border-width: 1px;
      border-color: blue;
      padding-left: 3px;
      padding-right: 3px;
  }

    .negativecell {
      font-weight: normal;
      color: red;
      border-style: solid;
      border-width: 1px;
      border-color: #ebe9e9;
      padding-left: 3px;
      padding-right: 3px;
  }

  #pickbutt1 #pickbutt2 {
    cursor: pointer;
  }

  </style>

  <script>
    function CopyToClipboard(containerid) {
      if (document.selection) {
        var range = document.body.createTextRange();
        range.moveToElementText(document.getElementById(containerid));
        range.select().createTextRange();
        document.execCommand("copy");
      } 
      else if (window.getSelection) {
        var range = document.createRange();
        range.selectNode(document.getElementById(containerid));
        window.getSelection().addRange(range);
        document.execCommand("copy");
        alert("Text has been copied, now paste into the target area");
      }
    }
  </script>

  <script>
    function print(fileName) {
      alert("printing ...");
      var el = document.getElementById(fileName);

      var win = window.open('', '', 'height=700,width=700');
      win.document.write(el.outerHTML);
      win.document.close();
      win.print();
  }
  </script>

  <script>
    function clearTextbox(){
      document.getElementById("selected_BetTypex").value = "";
      document.getElementById("selected_accountx").value = "";
      document.getElementById("selected_ticketx").value = "";
    }
  </script>

  <script>
    function GenOverall_Excel_L1() {
        $.ajax({
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            type: "POST",
            url: "http://103.209.157.30:5106/API/GenExcel_OverallL1",
            data: JSON.stringify({ "InputText": document.getElementById("jsondata").innerText }),
            dataType: "json",
            crossDomain: true,
            success: function (response) {
                console.log("success");
                console.log("original file name: " + response);

                var converted = JSON.parse(response);
                console.log("converted: " + converted[0].FileName);

                document.getElementById("downloadbutton2").href = "http://103.209.157.30:5106/ExcelFiles/" + converted[0].FileName;
                document.getElementById("downloadbutton2").style.display = "block";
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
        
        console.log("done");
        
    }
  </script>

  <script>
    function GenOverall_Excel_L2_V3(me){
      

      var StartDate = document.getElementById("dtDateS").value;
      var EndDate = document.getElementById("dtDateE").value;

      var StartTime = $('#appt-time').val();
      var EndTime = $('#appt-time2').val();

      if (StartTime == "") {
        StartTime = "00:00:00";
      }

      if (EndTime == "") {
        EndTime = "23:59:59";
      }

      StartDate = StartDate + " " + StartTime;
      EndDate = EndDate + " " + EndTime;
      
      var BetType = $(me).attr("data-BetType");
      var LotteryTypeID = $(me).attr("data-LotteryTypeID");
      var linkname = $(me).attr("data-link");

      var txt1 = "Drill Down on Bet Type: " + BetType + "";

      // alert(StartDate + "\n" + EndDate + "\nBetType: " + BetType + "\nLotteryTypeID: " + LotteryTypeID + "\nReportTitle: " + txt1);

      $.ajax({
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
              },
              type: "POST",
              url: "http://103.209.157.30:5106/Bet/GenExcel_OverallL2_V3",
              data: JSON.stringify({ "BetType": BetType, "dateStart": StartDate, "dateEnd": EndDate , "LotteryTypeID" : LotteryTypeID , "ReportTitle": txt1}),
              dataType: "json",
              crossDomain: true,
              success: function (response) {
                alert("Excel file ready");
                var converted = JSON.parse(response);
                var fileName = "http://103.209.157.30:5106/ExcelFiles/" + converted[0].FileName;
                var nlink = "#" + linkname;
                // alert(nlink);

                // $(nlink).innerHTML = "Download";
                $(nlink).attr("href", fileName);
                document.getElementById(linkname).style = "display:block";
                  // document.getElementById("downloadbutton2").href = "http://103.209.157.30:5106/ExcelFiles/" + converted[0].FileName;
                  // document.getElementById("downloadbutton2").style.display = "block";
              },
              failure: function (response) {
                  console.log("failure");
              },
              error: function (response, status) {
                  console.log("error");
              }
          });
    }
  </script>

  <script>
      function GenOverall_Excel_L2() {
          $.ajax({
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
              },
              type: "POST",
              url: "http://103.209.157.30:5106/API/GenExcel_OverallL2_V2",
              data: JSON.stringify({ "InputText": document.getElementById("jsondataL2").innerText }),
              dataType: "json",
              crossDomain: true,
              success: function (response) {
                  var converted = JSON.parse(response);

                  document.getElementById("downloadbutton2").href = "http://103.209.157.30:5106/ExcelFiles/" + converted[0].FileName;
                  document.getElementById("downloadbutton2").style.display = "block";
              },
              failure: function (response) {
                  console.log("failure");
              },
              error: function (response, status) {
                  console.log("error");
              }
          });
          
          console.log("done");
      }
  </script>

  <script>
      function GenOverall_Excel_L3() {
          $.ajax({
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
              },
              type: "POST",
              url: "http://103.209.157.30:5106/API/GenExcel_OverallL3",
              data: JSON.stringify({ "InputText": document.getElementById("jsondataL3").innerText }),
              dataType: "json",
              crossDomain: true,
              success: function (response) {
                  console.log("success");
                  console.log("original file name: " + response);

                  var converted = JSON.parse(response);
                  console.log("converted: " + converted[0].FileName);

                  document.getElementById("downloadbutton2").href = "http://103.209.157.30:5106/ExcelFiles/" + converted[0].FileName;
                  document.getElementById("downloadbutton2").style.display = "block";
              },
              failure: function (response) {
                  console.log("failure");
              },
              error: function (response, status) {
                  console.log("error");
              }
          });

          console.log("done");
      }
  </script>

  <script>
      function GenOverall_Excel_L4() {
          $.ajax({
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
              },
              type: "POST",
              url: "http://103.209.157.30:5106/API/GenExcel_OverallL4",
              data: JSON.stringify({ "InputText": document.getElementById("jsondataL4").innerText }),
              dataType: "json",
              crossDomain: true,
              success: function (response) {
                  console.log("success");
                  console.log("original file name: " + response);

                  var converted = JSON.parse(response);
                  console.log("converted: " + converted[0].FileName);
                  document.getElementById("downloadbutton2").href = "http://103.209.157.30:5106/ExcelFiles/" + converted[0].FileName;
                  document.getElementById("downloadbutton2").style.display = "block";
                  console.log(document.getElementById("downloadlink2").href);
              },
              failure: function (response) {
                  console.log("failure");
              },
              error: function (response, status) {
                  console.log("error");
              }
          });
        
          console.log("done");
      }
  </script>

  <script>
    $(document).ready(function(){
      // checkbrowser();
      // var browser_tboxwidth = "190px";
      // if (document.getElementById("browsertype").value == "Firefox") {
      //   browser_tboxwidth = "180px";
      // }

      // document.getElementById("selected_BetTypex").style.width = browser_tboxwidth;
      // document.getElementById("selected_accountx").style.width = browser_tboxwidth;
      // document.getElementById("selected_ticketx").style.width = browser_tboxwidth;

      // var closebuttleft = screen.width - 480;

      // document.getElementById("closebutton2").style.left = closebuttleft + "px";
      // document.getElementById("excelbutton2").style.left = closebuttleft + "px";
      // document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
      // document.getElementById("prevbutton2").style.left = closebuttleft + "px";

      // document.getElementById("copybutton2").style.left = closebuttleft + "px";
      // document.getElementById("printbutton2").style.left = closebuttleft + "px";      
      getToday();
      checkbrowser();
    })
  </script>

  <script>
    function showArea(area){
      if (area == "L1") {
        document.getElementById("L1Area").style.display = "inline-block";
        document.getElementById("L2Area").style.display = "none";
        document.getElementById("L3Area").style.display = "none";
        document.getElementById("L4Area").style.display = "none";
      }
      else if (area == "L2") {
        document.getElementById("L1Area").style.display = "none";
        document.getElementById("L2Area").style.display = "inline-block";
        document.getElementById("L3Area").style.display = "none";
        document.getElementById("L4Area").style.display = "none";
        document.getElementById('prevbutton2').setAttribute("onclick", "showArea('L1')");
      }
      else if (area == "L3") {
        document.getElementById("L1Area").style.display = "none";
        document.getElementById("L2Area").style.display = "none";
        document.getElementById("L3Area").style.display = "inline-block";
        document.getElementById("L4Area").style.display = "none";
        document.getElementById('prevbutton2').setAttribute("onclick", "showArea('L2')");
      }
      else if (area == "L4") {
        document.getElementById("L1Area").style.display = "none";
        document.getElementById("L2Area").style.display = "none";
        document.getElementById("L3Area").style.display = "none";
        document.getElementById("L4Area").style.display = "inline-block";
        document.getElementById('prevbutton2').setAttribute("onclick", "showArea('L3')");
      }
    }
  </script>

  <script>
    function getToday(){
      var today = new Date();
      var sdate = today.getFullYear() + "-" + ("0" + (today.getMonth() + 1)).slice(-2) + "-" + today.getDate() ;
      var edate = today.getFullYear() + "-" + ("0" + (today.getMonth() + 1)).slice(-2) + "-" + today.getDate() ;

      document.getElementById("dtDateS").value = sdate;
      document.getElementById("dtDateE").value = edate;

    }
  </script>

  <script>
    function getYesterday(){
      $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/API/GetYesterday",
            data: JSON.stringify({ "InputText": "" }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              // alert("Yesterday once more");
              var today = response.ReturnText;
              var sdate = today ;
              var edate = today ;

              document.getElementById("dtDateS").value = sdate;
              document.getElementById("dtDateE").value = edate;

              // GenOverallReport();
              readList();

            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
    }
  </script>


  <script>
    function get7Days(){
      alert("get7Days");
      $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/API/Get7Days",
            data: JSON.stringify({ "InputText": "" }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              var sdate = response.StartDate ;
              var edate = response.EndDate ;

              document.getElementById("dtDateS").value = sdate;
              document.getElementById("dtDateE").value = edate;

              GenOverallReport();
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
    }
  </script>

  <script>
    function get14Days(){
      $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/API/Get14Days",
            data: JSON.stringify({ "InputText": "" }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              var sdate = response.StartDate ;
              var edate = response.EndDate ;

              document.getElementById("dtDateS").value = sdate;
              document.getElementById("dtDateE").value = edate;

              GenOverallReport();

            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
    }
  </script>

  <script>
    function hidemenu(){
      alert("hiding menu");

      var browser_tboxwidth = "200px";

      if (document.getElementById("browsertype").value == "Firefox") {
        browser_tboxwidth = "180px";
      }

        var brleft = "5px";
        var brmleft = "5px";
        var brburleft = "5px";

        var brbtnleft = "35px";
        var brbtnmleft = "10px";

        document.getElementById("menuDiv").style.display = "none";
        // document.getElementById("myDIVx").style.left = brleft;
        // document.getElementById("myDIVx").style.position = "absolute";
        // document.getElementById("myDIVx").style.width = "85%";
        // document.getElementById("myDIVx").style.marginLeft  = brmleft;
        // document.getElementById("mySearchElements").style.width = "85%";
        // document.getElementById("mySearchElements").style.left = brleft;
        // document.getElementById("mySearchElements").style.marginLeft  = brmleft;
        document.getElementById("myDIVx").setAttribute("data-viewstate", "big");

        // document.getElementById("L1Area").style.width = "85%";
        // document.getElementById("L1Area").style.left = brleft;
        // document.getElementById("L1Area").style.marginLeft  = brmleft;

        // document.getElementById("L2Area").style.width = "85%";
        // document.getElementById("L2Area").style.left = brleft;
        // document.getElementById("L2Area").style.marginLeft  = brmleft;

        // document.getElementById("L3Area").style.width = "85%";
        // document.getElementById("L3Area").style.left = brleft;
        // document.getElementById("L3Area").style.marginLeft  = brmleft;

        // document.getElementById("L4Area").style.width = "85%";
        // document.getElementById("L4Area").style.left = brleft;
        // document.getElementById("L4Area").style.marginLeft  = brmleft;

        // document.getElementById("myButtons").style.left = brbtnleft;
        // document.getElementById("myButtons").style.marginLeft  = brbtnmleft;

        // document.getElementById("selected_BetType").style.width = browser_tboxwidth;
        // document.getElementById("selected_account").style.width = browser_tboxwidth;
        // document.getElementById("selected_ticket").style.width = browser_tboxwidth;

        checkbrowser();
    }
  </script>

  <script>
    function checkbrowser(){
      var uag = navigator.userAgent;
      var browsertype = "";

      if (uag.search("Firefox") != -1) {
        browsertype = "Firefox";

        if ((uag.search("Android") != -1)) {
          browsertype = "Android Firefox";
        }
      }
      else if ((uag.search("Chrome") != -1)) {
        browsertype = "Chrome";

        if ((uag.search("Android") != -1)) {
          browsertype = "Android Chrome";
        }
      }
      else if ((uag.search("Edg/") != -1)) {
        browsertype = "Edge";
      }
      else if ((uag.search("OPR/") != -1)) {
        browsertype = "Opera";
      }
      else if ((uag.search("Mac OS X") != -1)) {
        browsertype = "iphone";
      }

      
      document.getElementById("browsertype").value = browsertype;

      var output = 'Detecting browsers:<hr>';
      output += document.getElementById("browsertype").value;
      document.getElementById("CheckingArea").innerHTML = output;

      if (browsertype == "Android Chrome" || browsertype == "Android Firefox" || browsertype == "iphone") {
        var maxWidth = window.innerWidth - 35;
        var ttwidth = maxWidth - 5 + "px";

        if (window.innerWidth <= 360 || browsertype == "iphone") {
          $("#ckydummy").css("width", "5px");
          $("#selected_ticketx").css("width", "150px");
          $("#selected_accountx").css("width", "150px");
          $("#selected_BetTypex").css("width", "150px");
        }

        document.getElementById("myDIVx").style.left = "0px";
        document.getElementById("mySearchElements").style.left = "0px";
        document.getElementById("L1Area").style.left = "0px";
        document.getElementById("L2Area").style.left = "0px";
        document.getElementById("L3Area").style.left = "0px";
        document.getElementById("L4Area").style.left = "0px";

        document.getElementById("myDIVx").style.marginLeft = "0px";
        document.getElementById("mySearchElements").style.marginLeft = "0px";
        document.getElementById("L1Area").style.marginLeft = "0px";
        document.getElementById("L2Area").style.marginLeft = "0px";
        document.getElementById("L3Area").style.marginLeft = "0px";
        document.getElementById("L4Area").style.marginLeft = "0px";

        // document.getElementById("myDIVx").style.top = "205px";
        document.getElementById("mySearchElements").style.top = "240px";
        document.getElementById("mySearchElements").style.height = "255px";

        document.getElementById("L1Area").style.top = "508px";
        document.getElementById("L2Area").style.top = "508px";
        document.getElementById("L3Area").style.top = "508px";
        document.getElementById("L4Area").style.top = "508px";

        document.getElementById("L1Area").style.maxHeight = "375px";
        document.getElementById("L2Area").style.maxHeight = "355px";
        document.getElementById("L3Area").style.maxHeight = "355px";
        document.getElementById("L4Area").style.maxHeight = "355px";

        // document.getElementById("myDIVx").style.maxWidth = 230 + "px";
        document.getElementById("mySearchElements").style.maxWidth = ttwidth;
        document.getElementById("L1Area").style.maxWidth = ttwidth;
        document.getElementById("L2Area").style.maxWidth = ttwidth;
        document.getElementById("L3Area").style.maxWidth = ttwidth;
        document.getElementById("L4Area").style.maxWidth = ttwidth;

        document.getElementById("mySearchElements").style.width = ttwidth;
        document.getElementById("L1Area").style.width = ttwidth;
        document.getElementById("L2Area").style.width = ttwidth;
        document.getElementById("L3Area").style.width = ttwidth;
        document.getElementById("L4Area").style.width = ttwidth;

        //--- special treatment for Seach Condition ------
        var tabletext = "<span>Search Condition</span>";

        $("#myDIVx").css("display", "none");

        $("#myDIVx").toggleClass("ng-scope", "none");

        $("#specialtitle").html(tabletext);
        $("#specialtitle").css("background", "red");
        $("#specialtitle").css("position", "absolute");
        $("#specialtitle").css("top", "205px");
        $("#specialtitle").css("left", "0");
        $("#specialtitle").css("height", "35px");
        $("#specialtitle").css("display", "fixed");
        $("#specialtitle").css("word-wrap", "normal");
        $("#specialtitle").css("width", ttwidth);
        $("#specialtitle").css("border", "250px");
        $("#specialtitle").css("border-radius", "10px 10px 0px 0px");
        $("#specialtitle").css("padding-left", "10px");
        $("#specialtitle").css("padding-top", "9px");
        $("#specialtitle").css("padding-bottom", "0px");
        $("#specialtitle").css("font-family", "Arial Black");
        $("#specialtitle").css("font-weight", "900");
        $("#specialtitle").css("font-size", "15px");
        $("#specialtitle").css("z-index", '999999');
        $("#specialtitle").css("background-color", '#007E9F');
        $("#specialtitle").css("color", '#ffffff');

        //--------------------------------------------------------

        document.getElementById("mySearchElements").style.width = ttwidth;
        $("#mySearchElements").css("height", '265px');

        document.getElementById("L1Area").style.width = ttwidth;
        document.getElementById("L2Area").style.width = ttwidth;
        document.getElementById("L3Area").style.width = ttwidth;
        document.getElementById("L4Area").style.width = ttwidth;

        document.getElementById("L1Area").style.overflow = "scroll";
        document.getElementById("L2Area").style.overflow = "scroll";
        document.getElementById("L3Area").style.overflow = "scroll";
        document.getElementById("L4Area").style.overflow = "scroll";

        var closebuttleft = window.innerWidth - 40;

        if (window.innerWidth < 412) {
          closebuttleft = window.innerWidth - 35;
        }

        document.getElementById("closebutton2").style.left = closebuttleft + "px";
        document.getElementById("copybutton2").style.left = closebuttleft + "px";
        document.getElementById("copybutton2").style.left = closebuttleft + "px";
        document.getElementById("printbutton2").style.left = closebuttleft + "px"; 
        document.getElementById("excelbutton2").style.left = closebuttleft + "px";
        document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
        document.getElementById("prevbutton2").style.left = closebuttleft + "px";

        document.getElementById("closebutton2").style.display = "inline-block";
        document.getElementById("closebutton2").style.zIndex = 99999;
        document.getElementById("copybutton2").style.zIndex = 99999;
        document.getElementById("printbutton2").style.zIndex = 99999;
        document.getElementById("excelbutton2").style.zIndex = 99999;
        document.getElementById("downloadbutton2").style.zIndex = 99999;
        document.getElementById("prevbutton2").style.zIndex = 99999;

        var buttTop = 240;
        document.getElementById("closebutton2").style.top = buttTop + "px";
        document.getElementById("copybutton2").style.top = buttTop + 25 + "px";
        document.getElementById("printbutton2").style.top = buttTop + 50 + "px";
        document.getElementById("excelbutton2").style.top = buttTop + 75 + "px";
        document.getElementById("downloadbutton2").style.top = buttTop + 100 + "px";
        document.getElementById("prevbutton2").style.top = buttTop + 125 + "px";
      }
      else {
        // alert("Am on desktop");
        var maxWidth = window.innerWidth - 35;
        var ttwidth = maxWidth - 5 + "px";
        
        document.getElementById("myDIVx").style.top = "0px";
        document.getElementById("mySearchElements").style.top = "40px";
        document.getElementById("mySearchElements").style.height = "95px";
        document.getElementById("mySearchElements").style.maxWidth = "95%";
        document.getElementById("mySearchElements").style.width = "95%";

        document.getElementById("myDIVx").style.width = "95%";

        document.getElementById("L1Area").style.top = "135px";
        document.getElementById("L2Area").style.top = "135px";
        document.getElementById("L3Area").style.top = "135px";
        document.getElementById("L4Area").style.top = "135px";

        document.getElementById("L1Area").style.maxHeight = "900px";
        document.getElementById("L2Area").style.maxHeight = "900px";
        document.getElementById("L3Area").style.maxHeight = "900px";
        document.getElementById("L4Area").style.maxHeight = "900px";

        document.getElementById("L1Area").style.height = "900px";
        document.getElementById("L2Area").style.height = "900px";
        document.getElementById("L3Area").style.height = "900px";
        document.getElementById("L4Area").style.height = "900px";

        document.getElementById("L1Area").style.maxWidth = "95%";
        document.getElementById("L2Area").style.maxWidth = "95%";
        document.getElementById("L3Area").style.maxWidth = "95%";
        document.getElementById("L4Area").style.maxWidth = "95%";

        var tabletext = "<span>Search Condition</span>";

        // $("#myDIVx").css("display", "none");

        // $("#myDIVx").toggleClass("ng-scope", "none");

        // $("#specialtitle").html(tabletext);
        // $("#specialtitle").css("background", "red");
        // $("#specialtitle").css("position", "absolute");
        // $("#specialtitle").css("top", "205px");
        // $("#specialtitle").css("left", "0");
        // $("#specialtitle").css("height", "35px");
        // $("#specialtitle").css("display", "fixed");
        // $("#specialtitle").css("word-wrap", "normal");
        // $("#specialtitle").css("width", ttwidth);
        // $("#specialtitle").css("border", "250px");
        // $("#specialtitle").css("border-radius", "10px 10px 0px 0px");
        // $("#specialtitle").css("padding-left", "10px");
        // $("#specialtitle").css("padding-top", "9px");
        // $("#specialtitle").css("padding-bottom", "0px");
        // $("#specialtitle").css("font-family", "Arial Black");
        // $("#specialtitle").css("font-weight", "900");
        // $("#specialtitle").css("font-size", "15px");
        // $("#specialtitle").css("z-index", '999999');
        // $("#specialtitle").css("background-color", '#007E9F');
        // $("#specialtitle").css("color", '#ffffff');

        var copyrightleft = parseInt( window.innerWidth / 2) - 500;
        document.getElementById("copyright2").style.position = "absolute";
        document.getElementById("copyright2").style.left = copyrightleft + "px";
        var hh = document.getElementById("L1Area").offsetHeight;
        var tt = document.getElementById("L1Area").offsetTop;

        document.getElementById("copyright2").style.position = "absolute";
        document.getElementById("copyright2").style.display = "block";
        document.getElementById("copyright2").style.top = window.innerHeight + "px";
      }
      var t1 = "myDIVx top: " + document.getElementById("myDIVx").style.top;
      var t2 = "mySearchElements top: " + document.getElementById("mySearchElements").style.top;
      var t3 = "L1Area top: " + document.getElementById("L1Area").style.top;

      var w1 = "myDIVx width:" + document.getElementById("myDIVx").offsetWidth;
      var w2 = "mySearchElements width:" + document.getElementById("mySearchElements").offsetWidth;
      var w3 = "L1Area width:" + document.getElementById("L1Area").offsetWidth;

    }
  </script>

  <script>
      function EnableButtons() {
          document.getElementById("btnOverall").disabled = false; 
          document.getElementById("btnTicket").disabled = false; 
          document.getElementById("btnAccounts").disabled = false;
          document.getElementById("btnBetTypes").disabled = false;

          document.getElementById("btnOverall").style.cursor = "pointer";
          document.getElementById("btnTicket").style.cursor = "pointer";
          document.getElementById("btnAccounts").style.cursor = "pointer";
          document.getElementById("btnBetTypes").style.cursor = "pointer";
      }
  </script>

  <script>
      function DisableButtons() {
          document.getElementById("btnOverall").disabled = true; 
          document.getElementById("btnTicket").disabled = true; 
          document.getElementById("btnAccounts").disabled = true;
          document.getElementById("btnBetTypes").disabled = true;

          document.getElementById("btnOverall").style.cursor = "none";
          document.getElementById("btnTicket").style.cursor = "none";
          document.getElementById("btnAccounts").style.cursor = "none";
          document.getElementById("btnBetTypes").style.cursor = "none";          
      }
  </script>

  <script>
      function GenOverallReport() {
          document.getElementById("CheckingArea").style.display = "none";

          var txt = "<img src='http://103.209.157.30:5106/clock.gif' />";
          document.getElementById("L1Area").style.textAlign = "center";
          document.getElementById("L1Area").innerHTML = txt;

          document.getElementById("L1Area").style.display = "inline-block";
          document.getElementById("L2Area").style.display = "none";
          document.getElementById("L3Area").style.display = "none";
          document.getElementById("L4Area").style.display = "none";

          document.getElementById("prevbutton2").disabled = true;
          document.getElementById("prevbutton2").style.cursor = "none";

          document.getElementById("downloadbutton2").style.display = "none";

          var today = new Date();
          var sdate = today.getFullYear() + "-" + (today.getMonth() + 1) + "-" + today.getDate();
          var edate = today.getFullYear() + "-" + (today.getMonth() + 1) + "-" + today.getDate();
          
          var StartDate = document.getElementById("dtDateS").value;
          var EndDate = document.getElementById("dtDateE").value;

          var CurrentPeriod = document.getElementById("selected_ticketx").value;
          var UserName = document.getElementById("selected_accountx").value;
          var BetType = document.getElementById("selected_BetTypex").value;

          var StartTime = $('#appt-time').val();
          var EndTime = $('#appt-time2').val();

          if (StartTime == "") {
            StartTime = "00:00:00";
          }

          if (EndTime == "") {
            EndTime = "23:59:59";
          }

          if (CurrentPeriod != "") {
            GetCurrentPeriodDates(CurrentPeriod);
          }

          document.getElementById("L1Area").style.textAlign = "left";
          testClass();
          var copyrightleft = parseInt( window.innerWidth / 2) - 200;
          document.getElementById("copyright2").style.left = copyrightleft + "px";
          var hh = document.getElementById("L1Area").offsetHeight;
          var tt = document.getElementById("L1Area").offsetTop;
          var cpt = hh + tt + 5;

          document.getElementById("copyright2").style.position = "absolute";
          document.getElementById("copyright2").style.display = "block";
          document.getElementById("copyright2").style.top = cpt + "px";

          checkbrowser(); // setting after data is populated

          var closebuttleft = document.getElementById("L1Area").offsetLeft + document.getElementById("L1Area").offsetWidth + 5;

          document.getElementById("closebutton2").style.left = closebuttleft + "px";
          document.getElementById("copybutton2").style.left = closebuttleft + "px";
          document.getElementById("copybutton2").style.left = closebuttleft + "px";
          document.getElementById("printbutton2").style.left = closebuttleft + "px"; 
          document.getElementById("excelbutton2").style.left = closebuttleft + "px";
          document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
          document.getElementById("prevbutton2").style.left = closebuttleft + "px";

          document.getElementById("closebutton2").style.top = document.getElementById("L1Area").style.top + "px";
          document.getElementById("copybutton2").style.top = document.getElementById("L1Area").style.top + 25 + "px";
          document.getElementById("copybutton2").style.top = document.getElementById("L1Area").style.top + 50 + "px";
          document.getElementById("printbutton2").style.top = document.getElementById("L1Area").style.top + 75 + "px";
          document.getElementById("excelbutton2").style.top = document.getElementById("L1Area").style.top + 100 + "px";
          document.getElementById("downloadbutton2").style.top = document.getElementById("L1Area").style.top + 125 + "px";
          document.getElementById("prevbutton2").style.top = document.getElementById("L1Area").style.top + 150 + "px";


          document.getElementById("excelbutton2").setAttribute("onclick", "GenOverall_Excel_L1()");

          document.getElementById("copybutton2").setAttribute("onclick", "CopyToClipboard('L1Area')"); // PrintContent
          document.getElementById("printbutton2").setAttribute("onclick", "print('L1Area')");

          var h = document.getElementById("L1Area").offsetHeight + 150;
          document.getElementById("L1Area").style.height = h + "px";
          document.getElementById("HistoryL1").innerHTML = txt;
/*
          $.ajax({
              type: "POST",
              url: "http://103.209.157.30:5106/API/GetOverallReport",
              data: JSON.stringify({ "StartDate": StartDate, "EndDate": EndDate, "CurrentPeriod": CurrentPeriod, "UserName": UserName, "BetType": BetType, "StartTime": StartTime, "EndTime": EndTime }),
              contentType: "application/json; charset=utf-8",
              dataType: "json",
              crossDomain: true,
              success: function (response) {
                  document.getElementById("L1Area").style.textAlign = "left";
                  document.getElementById("jsondata").innerText = JSON.stringify(response);
                  var mydata = JSON.parse(document.getElementById("jsondata").innerText);

                  var myrows = mydata.length;
                  var TotalTOver = 0;
                  var TotalPending = 0;
                  var TotalMemberWL = 0;
                  var TotalAgentWL = 0;
                  var TotalComWL = 0;
                  var TotalMAWL = 0;
                  var TotalSMWL = 0;
                  txt = "<table width='1400px' style='font-size:12px;' cellpadding=0 cellspacing=0>";
                  txt = txt + "<tr>";
                  txt = txt + "<td class='cellborder cellleft'>TypeName</td>";
                  txt = txt + "<td class='cellborder cellleft'>TOver</td>";
                  txt = txt + "<td class='cellborder cellleft'>Pending</td>";
                  txt = txt + "<td class='cellborder cellleft'>Member W/L Total</td>";
                  txt = txt + "<td class='cellborder cellleft'>Agent W/L Total</td>";
                  
                  txt = txt + "<td class='cellborder cellleft'>MA W/L Total</td>";
                  txt = txt + "<td class='cellborder cellleft'>SM W/L Total</td>";

                  txt = txt + "<td class='cellborder cellleft'>Com W/L Total</td>";
                  txt = txt + "</tr>";
                  for (let i = 0; i < myrows; i++) {
                    var cellclass = "";

                    if (i % 2 != 0) {
                      cellclass = "cellgrey";
                    }
                    else {
                      cellclass = "";
                    }

                    txt = txt + "<tr>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'><span class='bckPeal cellleft' style='font-weight:bold;' onclick='DrillBetType(this)' data-BetType='" + mydata[i].BetType + "'>" + mydata[i].BetType + "</span></td>";

                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].TOver).toFixed(4))  + "</td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].Pending).toFixed(4))  + "</td>";
                    if (Number(mydata[i].MemberWinLose) < 0) {
                        txt = txt + "<td class='negativecell celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].MemberWinLose).toFixed(4)) + "</td>";
                    }
                    else {
                        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].MemberWinLose).toFixed(4)) + "</td>";
                    }

                    if (Number(mydata[i].AgentWinLose) >= 0) {
                        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].AgentWinLose).toFixed(4) ) + "</td>";
                    }
                    else {
                        txt = txt + "<td class='negativecell celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].AgentWinLose).toFixed(4) ) + "</td>";
                    }

                    
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].MAWinLose).toFixed(4) ) + "</td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].SMWinLose).toFixed(4) ) + "</td>";

                    if (Number(mydata[i].ComWinLose) >= 0) {
                        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].ComWinLose).toFixed(4) ) + "</td>";
                    }
                    else {
                        txt = txt + "<td class='negativecell celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].ComWinLose).toFixed(4) ) + "</td>";
                    }

                    txt = txt + "</tr>";
                    TotalTOver = TotalTOver + Number(mydata[i].TOver.toString());
                    TotalPending = TotalPending + Number(mydata[i].Pending.toString());
                    TotalMemberWL = TotalMemberWL + Number(mydata[i].MemberWinLose.toString());
                    TotalAgentWL = TotalAgentWL + Number(mydata[i].AgentWinLose.toString());
                    TotalComWL = TotalComWL + Number(mydata[i].ComWinLose.toString());
                    TotalMAWL = TotalMAWL + Number(mydata[i].MAWinLose.toString());
                    TotalSMWL = TotalSMWL + Number(mydata[i].SMWinLose.toString());
                  }
                  
                  if (myrows % 2 != 0) {
                    cellclass = "cellgrey";
                  }
                  else {
                    cellclass = "celldata";
                  }
                  txt = txt + "<tr>";
                  txt = txt + "<td class='sumcell cellleft " + cellclass + "'><span style='font-weight:500;'>Total</span></td>";
                  txt = txt + "<td class='sumcell cellleft " + cellclass + "'>" + formatcomma(TotalTOver.toFixed(4)) + "</td>";
                  txt = txt + "<td class='sumcell cellleft " + cellclass + "'>" + formatcomma(TotalPending.toFixed(4)) + "</td>";
                  if (TotalMemberWL < 0) {
                      txt = txt + "<td class='negativecell sumcell cellleft " + cellclass + "'>" + formatcomma(TotalMemberWL.toFixed(4)) + "</td>";
                  }
                  else {
                      txt = txt + "<td class='sumcell cellleft " + cellclass + "'>" + formatcomma(TotalMemberWL.toFixed(4)) + "</td>";
                  }
                  txt = txt + "<td class='sumcell cellleft " + cellclass + "'>" + formatcomma(TotalAgentWL.toFixed(4)) + "</td>";
                  
                  txt = txt + "<td class='sumcell cellleft " + cellclass + "'>" + formatcomma(TotalMAWL.toFixed(4)) + "</td>";
                  txt = txt + "<td class='sumcell cellleft " + cellclass + "'>" + formatcomma(TotalSMWL.toFixed(4)) + "</td>";

                  txt = txt + "<td class='sumcell cellleft " + cellclass + "'>" + formatcomma(TotalComWL.toFixed(4)) + "</td>";
                  txt = txt + "</tr>";
                  
                  document.getElementById("jsondata").innerText = '{ "ReportTitle": "Win/Lose Report by Game - Overall View (Level 1)", "Data" : ' + document.getElementById("jsondata").innerText + '}';

                  

                  document.getElementById("L1Area").innerHTML = txt;
                  var copyrightleft = parseInt( window.innerWidth / 2) - 200;
                  document.getElementById("copyright2").style.left = copyrightleft + "px";
                  var hh = document.getElementById("L1Area").offsetHeight;
                  var tt = document.getElementById("L1Area").offsetTop;
                  var cpt = hh + tt + 5;

                  document.getElementById("copyright2").style.position = "absolute";
                  document.getElementById("copyright2").style.display = "block";
                  document.getElementById("copyright2").style.top = cpt + "px";

                  checkbrowser(); // setting after data is populated

                  var closebuttleft = document.getElementById("L1Area").offsetLeft + document.getElementById("L1Area").offsetWidth + 5;

                  document.getElementById("closebutton2").style.left = closebuttleft + "px";
                  document.getElementById("copybutton2").style.left = closebuttleft + "px";
                  document.getElementById("copybutton2").style.left = closebuttleft + "px";
                  document.getElementById("printbutton2").style.left = closebuttleft + "px"; 
                  document.getElementById("excelbutton2").style.left = closebuttleft + "px";
                  document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
                  document.getElementById("prevbutton2").style.left = closebuttleft + "px";

                  document.getElementById("closebutton2").style.top = document.getElementById("L1Area").style.top + "px";
                  document.getElementById("copybutton2").style.top = document.getElementById("L1Area").style.top + 25 + "px";
                  document.getElementById("copybutton2").style.top = document.getElementById("L1Area").style.top + 50 + "px";
                  document.getElementById("printbutton2").style.top = document.getElementById("L1Area").style.top + 75 + "px";
                  document.getElementById("excelbutton2").style.top = document.getElementById("L1Area").style.top + 100 + "px";
                  document.getElementById("downloadbutton2").style.top = document.getElementById("L1Area").style.top + 125 + "px";
                  document.getElementById("prevbutton2").style.top = document.getElementById("L1Area").style.top + 150 + "px";


                  document.getElementById("excelbutton2").setAttribute("onclick", "GenOverall_Excel_L1()");

                  document.getElementById("copybutton2").setAttribute("onclick", "CopyToClipboard('L1Area')"); // PrintContent
                  document.getElementById("printbutton2").setAttribute("onclick", "print('L1Area')");

                  var h = document.getElementById("L1Area").offsetHeight + 150;
                  document.getElementById("L1Area").style.height = h + "px";
                  document.getElementById("HistoryL1").innerHTML = txt;
              },
              failure: function (response) {
                  console.log("failure");
              },
              error: function (response, status) {
                  console.log("error");
              }
          });
*/          
      }
  </script>

  <script>
    function DrillBetTypeV2(me) {
      document.getElementById("CheckingArea").style.display = "none";

          document.getElementById("L2Area").style.textAlign = "center";
          var txt = "<img src='http://103.209.157.30:5106/clock.gif' />";
          document.getElementById("L2Area").innerHTML = txt;

          document.getElementById("L1Area").style.display = "none";
          document.getElementById("L2Area").style.display = "inline-block";
          document.getElementById("L3Area").style.display = "none";
          document.getElementById("L4Area").style.display = "none";

          document.getElementById("prevbutton2").disabled = false;
          document.getElementById("prevbutton2").style.cursor = "pointer";

          document.getElementById("downloadbutton2").style.display = "none";

          var StartDate = document.getElementById("dtDateS").value;
          var EndDate = document.getElementById("dtDateE").value;

          var StartTime = $('#appt-time').val();
          var EndTime = $('#appt-time2').val();

          if (StartTime == "") {
            StartTime = "00:00:00";
          }

          if (EndTime == "") {
            EndTime = "23:59:59";
          }

          StartDate = StartDate + " " + StartTime;
          EndDate = EndDate + " " + EndTime;
          
          var BetType = $(me).attr("data-BetType");
          var LotteryTypeID = $(me).attr("data-LotteryTypeID");

          // alert("Bet Type: " + BetType + "\nLotteryTypeID: " + LotteryTypeID + "\nStartDate: " + StartDate + "\nEndDate: " + EndDate);

          $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/Bet/GetMPlayerUsers",
            data: JSON.stringify({ "BetType": BetType, "dateStart": StartDate, "dateEnd": EndDate , "LotteryTypeID" : LotteryTypeID}),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              // alert("success in getting Mplayer users: " + response.length);
              ShowL2Report(response, BetType);
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
    }
  </script>

  <script>
    function ShowL2Report(response, BetType) {
      // alert("At Level 2: " + response.length);

      var objList = [];
      for (let j = 0; j < response.length; j++) {
        var myobj = {
          "UserName": response[j].UserName.toString(),
          "CurrentPeriod": response[j].CurrentPeriod.toString(),
          "ShowResultDate": response[j].ShowResultDate.toString().replaceAll("T", " "),
          "UpdateDate": response[j].UpdateDate.toString().replaceAll("T", " "),
          "TurnOver": response[j].TOver.toString(),
          "TotalWin": response[j].TotalWin.toString(),
          "TotalLost": response[j].TotalLost.toString(),
          "WL": response[j].WL.toString(),
          "TotalPending": response[j].TotalPending.toString(),
          "Key": "",
          "ABC": "",
          "AB": ""
        }

        objList.push(myobj);
      }

      document.getElementById("jsondataL2").innerText = JSON.stringify(objList);
      var mydata = JSON.parse(document.getElementById("jsondataL2").innerText);
      var myrows = mydata.length;

      // alert(myrows);

      //---- setup the key -----
      for (let i = 0; i < myrows; i++) {
        mydata[i].Key = mydata[i].UserName + "-" + mydata[i].CurrentPeriod + "-" + mydata[i].ShowResultDate + "-" + mydata[i].UpdateDate;
        mydata[i].ABC = mydata[i].UserName + "-" + mydata[i].CurrentPeriod + "-" + mydata[i].ShowResultDate;
        mydata[i].AB = mydata[i].UserName + "-" + mydata[i].CurrentPeriod;
      }

      // alert("key settting done!");

      //--- sorting the array -----
      mydata.sort(function(c, d){

          let x = c.Key.toLowerCase();
          let y = d.Key.toLowerCase();
          if (x < y) {return -1;}
          if (x > y) {return 1;}

          return 0;
      });

      mydata.sort(function(c, d){

          let x = c.ABC.toLowerCase();
          let y = d.ABC.toLowerCase();
          if (x < y) {return -1;}
          if (x > y) {return 1;}

          return 0;
      });

      var SearchList = [];

      for (let i = 0; i < myrows; i++) {
        SearchList.push(mydata[i]);
      }

      // alert("key sorting done!");

      //---- mydata is sorted on [User]; [User, Ticket and Opening Time] as ABC ---------------------------

      var ttTOver = 0;
      var ttTotalWin = 0;
      var ttTotalLost = 0;
      var ttPending = 0;
      var ttWL = 0;

      var txt1 = "<span style='font-family: Helvetica;font-size: 12px;font-weight:bold;color:red;'>Drill Down on Bet Type: " + BetType + "</span><br>";
      var txt = "<table style='font-size:12px; width:1400px;' cellpadding=0 cellspacing=0>";
      txt = txt + "<tr>";
      txt = txt + "<td class='cellborder cellleft'>UserName</td>";
      txt = txt + "<td class='cellborder cellleft'>BillNo</td>";
      txt = txt + "<td class='cellborder cellleft'>OpeningTime</td>";
      txt = txt + "<td class='cellborder cellleft'>UpdateTime</td>";
      txt = txt + "<td class='cellborder cellleft'>TOver</td>";
      txt = txt + "<td class='cellborder cellleft'>Win</td>";
      txt = txt + "<td class='cellborder cellleft'>Lose</td>";
      txt = txt + "<td class='cellborder cellleft'>Member W/L</td>";
      txt = txt + "<td class='cellborder cellleft'>Pending</td>";
      txt = txt + "</tr>";

      var prevUser = "";
      var prevABC = "";
      var prevAB = "";

      var rowspan = 1;

      var UserRow = 0;
      var ABRow = 0;
      var ABCRow = 0;

      var IsFirstTime = false;

      // alert(txt);

      for (let i = 0; i < myrows; i++) {
        //---- at first time, first record ----------------------------------
        // alert("CurrentRow point 1: " + i);

        if (i == 0) {
          prevUser = mydata[i].UserName;
          prevAB = mydata[i].AB;
          prevABC = mydata[i].ABC;

          UserRow = 0;
          ABRow = 0;
          ABCRow = 0;

          IsFirstTime = true;
        }

        // alert(mydata[i].UserName + " ~vs~ " +  prevUser + " ~~ i: " + i);

        if (i !=0 && mydata[i].UserName != prevUser) {
          prevUser = mydata[i].UserName;
          prevAB = mydata[i].AB;
          prevABC = mydata[i].ABC;

          UserRow = 0;
          ABRow = 0;
          ABCRow = 0;

          IsFirstTime = true;
        }

        for (let t = 0; t < myrows; t++) {
          if (SearchList[t].UserName == prevUser) {
            UserRow++;
          }

          if (SearchList[t].AB == prevAB && SearchList[t].UserName == prevUser) {
            ABRow++;
          }

          if (SearchList[t].ABC == prevABC && SearchList[t].AB == prevAB && SearchList[t].UserName == prevUser) {
            ABCRow++;
          }
        }

        if (UserRow > 1) {
          UserRow = UserRow - 1;
          ABRow = ABRow - 1;
        }

        if (prevUser == "DAIB_HHHAABL1GUE") {
          // alert(i + " UserRow: " + UserRow);
          // alert(i + " ABRow: " + ABRow);
        }

        // alert("CurrentRow point 2: " + i);

        var cellclass = "";
        // alert("CurrentRow point 3: " + i);

        var otime = mydata[i].ShowResultDate;
        // alert("CurrentRow point 4: " + i);
        var utime = mydata[i].UpdateDate.toString().replaceAll("T", " ");

        txt = txt + "<tr>";

        

        var myi = i;
        if (i % 2 != 0) {
          cellclass = "cellgrey";
        }
        else {
          cellclass = "";
        }

        UserRow = 1;
        ABRow = 1;
        ABCRow = 1;

        //-------- first merged column on User Name ------------------------
        // alert("IsFirstTime: " + IsFirstTime + "\nPrevUser: " + prevUser + "\nUserName: " + mydata[i].UserName);

        if (IsFirstTime && mydata[i].UserName == prevUser) {
          txt = txt + "<td valign='top' rowspan="+ UserRow + " class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span onclick='DrillByUserName(this)' class='bckPeal cellleft' data-UserName='" + mydata[i].UserName + "' data-BetType='" + BetType + "'>" + mydata[i].UserName + "</span></td>";
          // IsFirstTime = false;
        }
        else {
          txt = txt + "<td></td>";
        }

        
        // second merged field ----------------------------------
        if (IsFirstTime && mydata[i].AB == prevAB && mydata[i].UserName == prevUser) {
          txt = txt + "<td valign='top' rowspan=" + ABRow + " class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span class='cellleft'>" + mydata[i].CurrentPeriod + "</span></td>";
          // IsFirstTime = false;
        }
        else {
          txt = txt + "<td></td>";
        }


        // second merged field ----------------------------------
        if (IsFirstTime && mydata[i].ABC == prevABC && mydata[i].AB == prevAB && mydata[i].UserName == prevUser) {
          txt = txt + "<td valign='top' rowspan=" + ABCRow + " class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span class='cellleft'>" + otime + "</span></td>";
        }
        else {
          txt = txt + "<td></td>";
        }

        
        IsFirstTime = false;

        

        txt = txt + "<td class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span class='cellleft'>" + utime + "</span></td>";
        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].TurnOver.toString()).toFixed(4) ) + "</td>";
        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalWin.toString()).toFixed(4)) + "</td>";
        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalLost.toString()).toFixed(4)) + "</td>";

        if (Number(mydata[i].WL.toString()) < 0) {
          txt = txt + "<td class='negativecell celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].WL.toString()).toFixed(4)) + "</td>";
        }
        else {
          txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].WL.toString()).toFixed(4)) + "</td>";
        }
        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalPending.toString()).toFixed(4)) + "</td>";

        txt = txt + "</tr>";
        prevUser = "";

        ttTOver = ttTOver + Number(mydata[i].TurnOver.toString());
        ttTotalWin = ttTotalWin + Number(mydata[i].TotalWin.toString());
        ttTotalLost = ttTotalLost + Number(mydata[i].TotalLost.toString());
        ttPending = ttPending + Number(mydata[i].TotalPending.toString());
        ttWL = ttWL + Number(mydata[i].WL.toString());


        // ----- before looping back to next item --------
        prevUser = mydata[i].UserName;
        prevAB = mydata[i].AB;
        prevABC = mydata[i].ABC;
        

        // alert("CurrentRow: " + i);
      }

      //---- final summary line ---------------------------------------

      // alert("Showing Summary Line");

      if (myrows % 2 != 0) {
        cellclass = "cellgrey";
      }
      else {
        cellclass = "celldata";
      }

      txt = txt + "<tr>";
      txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "' colspan=4><span style='font-weight:500;'>Total</span></td>";
      txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttTOver.toFixed(4) ) + "</td>";
      txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttTotalWin.toFixed(4)) + "</td>";
      txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttTotalLost.toFixed(4)) + "</td>";

      if (ttWL < 0) {
        txt = txt + "<td class='sumcell cellborder cellleft negativecell " + cellclass + "'>" + formatcomma(ttWL.toFixed(4)) + "</td>";
      }
      else {
        txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttWL.toFixed(4)) + "</td>";
      }
      txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttPending.toFixed(4)) + "</td>";
      txt = txt + "</tr>";

      document.getElementById("L2Area").innerHTML = txt1 + txt;

      var copyrightleft = parseInt( window.innerWidth / 2) - 200;
      document.getElementById("copyright2").style.left = copyrightleft + "px";
      var hh = document.getElementById("L2Area").offsetHeight;
      var tt = document.getElementById("L2Area").offsetTop;
      var cpt = hh + tt + 5;

      document.getElementById("copyright2").style.position = "absolute";
      document.getElementById("copyright2").style.display = "block";
      document.getElementById("copyright2").style.top = cpt + "px";

      checkbrowser();

      var closebuttleft = document.getElementById("L2Area").offsetLeft + document.getElementById("L2Area").offsetWidth + 5;

      document.getElementById("closebutton2").style.left = closebuttleft + "px";
      document.getElementById("copybutton2").style.left = closebuttleft + "px";
      document.getElementById("copybutton2").style.left = closebuttleft + "px";
      document.getElementById("printbutton2").style.left = closebuttleft + "px"; 
      document.getElementById("excelbutton2").style.left = closebuttleft + "px";
      document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
      document.getElementById("prevbutton2").style.left = closebuttleft + "px";

      document.getElementById("closebutton2").style.top = document.getElementById("L2Area").style.top + "px";
      document.getElementById("copybutton2").style.top = document.getElementById("L2Area").style.top + 25 + "px";
      document.getElementById("copybutton2").style.top = document.getElementById("L2Area").style.top + 50 + "px";
      document.getElementById("printbutton2").style.top = document.getElementById("L2Area").style.top + 75 + "px";
      document.getElementById("excelbutton2").style.top = document.getElementById("L2Area").style.top + 100 + "px";
      document.getElementById("downloadbutton2").style.top = document.getElementById("L2Area").style.top + 125 + "px";
      document.getElementById("prevbutton2").style.top = document.getElementById("L2Area").style.top + 150 + "px";

      var hh = document.getElementById("L2Area").offsetHeight;
      var tt = document.getElementById("L2Area").offsetTop;
      var cpt = hh + tt + 5;

      document.getElementById("copyright2").style.position = "absolute";
      document.getElementById("copyright2").style.display = "block";
      document.getElementById("copyright2").style.top = cpt + "px";

      document.getElementById('prevbutton2').setAttribute("onclick", "showArea('L1')");

      document.getElementById("excelbutton2").setAttribute("onclick", "GenOverall_Excel_L2()");
      document.getElementById("HistoryL2HD").innerHTML = txt1 + txt;
      document.getElementById("HistoryL2HD").style = "display: none;";
      document.getElementById("jsondataL2").innerText = '{ "ReportTitle": "Win/Lose Report by Game - Drill Down on Bet Type: ' + BetType + ' (Level 2)", "Data" : ' + document.getElementById("jsondataL2").innerText + '}';
      document.getElementById("HistoryL2").innerHTML = txt;
      document.getElementById("HistoryL2").style = "display: none;";

      const body = document.body;
      const html = document.documentElement;
      const height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);
      console.log(document.getElementById("jsondataL2").innerText);

      document.getElementById("copybutton2").setAttribute("onclick", "CopyToClipboard('L2Area')");
      document.getElementById("printbutton2").setAttribute("onclick", "print('L2Area')");
  }
  </script>

  <script>
      function DrillBetType(me) {
        
          document.getElementById("CheckingArea").style.display = "none";

          document.getElementById("L2Area").style.textAlign = "center";
          var txt = "<img src='http://103.209.157.30:5106/clock.gif' />";
          document.getElementById("L2Area").innerHTML = txt;

          document.getElementById("L1Area").style.display = "none";
          document.getElementById("L2Area").style.display = "inline-block";
          document.getElementById("L3Area").style.display = "none";
          document.getElementById("L4Area").style.display = "none";

          document.getElementById("prevbutton2").disabled = false;
          document.getElementById("prevbutton2").style.cursor = "pointer";

          document.getElementById("downloadbutton2").style.display = "none";
          
          var BetType = $(me).attr("data-BetType");
          var LotteryTypeID = $(me).attr("data-LotteryTypeID");
          var LotteryInfoID = $(me).attr("data-LotteryInfoID");
          var StartDate = document.getElementById("dtDateS").value;
          var EndDate = document.getElementById("dtDateE").value;

          alert("Bet Type: " + BetType + "\nLotteryTypeID: " + LotteryTypeID + "\nLotteryInfoID: " + LotteryInfoID + "\nStartDate: " + StartDate + "\nEndDate: " + EndDate);

          var CurrentPeriod = document.getElementById("selected_ticketx").value;
          var UserName = document.getElementById("selected_accountx").value;

          var StartTime = $('#appt-time').val();
          var EndTime = $('#appt-time2').val();

          if (StartTime == "") {
            StartTime = "00:00:00";
          }

          if (EndTime == "") {
            EndTime = "23:59:59";
          }

          StartDate = StartDate + " " + StartTime;
          EndDate = EndDate + " " + EndTime;

          if (CurrentPeriod != "") {
            GetCurrentPeriodDates(CurrentPeriod);
          }

          document.getElementById("selected_BetTypex").value = BetType;
          
          $.ajax({
              type: "POST",
              url: "http://103.209.157.30:5106/API/GetOverallByBetType",
              data: JSON.stringify({ "BetType": BetType, "StartDate": StartDate, "EndDate": EndDate, "CurrentPeriod": CurrentPeriod, "UserName": UserName, "StartTime": StartTime, "EndTime": EndTime }),
              contentType: "application/json; charset=utf-8",
              dataType: "json",
              crossDomain: true,
              success: function (response) {
                // alert("success");
                  var objList = [];
                  for (let j = 0; j < response.length; j++) {
                    var myobj = {
                      "UserName": response[j].UserName.toString(),
                      "BillNo": response[j].BillNo.toString(),
                      "OpeningTime": response[j].OpeningTime.toString().replaceAll("T", " "),
                      "UpdateDate": response[j].UpdateDate.toString().replaceAll("T", " "),
                      "TurnOver": response[j].TOver.toString(),
                      "TotalWin": response[j].TotalWin.toString(),
                      "TotalLost": response[j].TotalLost.toString(),
                      "WL": response[j].WL.toString(),
                      "TotalPending": response[j].TotalPending.toString(),
                      "Key": "",
                      "ABC": "",
                      "AB": ""
                    }

                    objList.push(myobj);
                  }

                  document.getElementById("jsondataL2").innerText = JSON.stringify(objList);
                  var mydata = JSON.parse(document.getElementById("jsondataL2").innerText);
                  var myrows = mydata.length;

                  //---- setup the key -----
                  for (let i = 0; i < myrows; i++) {
                    mydata[i].Key = mydata[i].UserName + "-" + mydata[i].BillNo + "-" + mydata[i].OpeningTime + "-" + mydata[i].UpdateDate;
                    mydata[i].ABC = mydata[i].UserName + "-" + mydata[i].BillNo + "-" + mydata[i].OpeningTime;
                    mydata[i].AB = mydata[i].UserName + "-" + mydata[i].BillNo;
                  }

                  //--- sorting the array -----
                  mydata.sort(function(c, d){
        
                      let x = c.Key.toLowerCase();
                      let y = d.Key.toLowerCase();
                      if (x < y) {return -1;}
                      if (x > y) {return 1;}

                      return 0;
                  });

                  mydata.sort(function(c, d){
        
                      let x = c.ABC.toLowerCase();
                      let y = d.ABC.toLowerCase();
                      if (x < y) {return -1;}
                      if (x > y) {return 1;}

                      return 0;
                  });

                  var SearchList = [];

                  for (let i = 0; i < myrows; i++) {
                    SearchList.push(mydata[i]);
                  }

                  //---- mydata is sorted on [User]; [User, Ticket and Opening Time] as ABC ---------------------------

                  var ttTOver = 0;
                  var ttTotalWin = 0;
                  var ttTotalLost = 0;
                  var ttPending = 0;
                  var ttWL = 0;

                  var txt1 = "<span style='font-family: Helvetica;font-size: 12px;font-weight:bold;color:red;'>Drill Down on Bet Type: " + BetType + "</span><br>";
                  var txt = "<table style='font-size:12px; width:1400px;' cellpadding=0 cellspacing=0>";
                  txt = txt + "<tr>";
                  txt = txt + "<td class='cellborder cellleft'>UserName</td>";
                  txt = txt + "<td class='cellborder cellleft'>BillNo</td>";
                  txt = txt + "<td class='cellborder cellleft'>OpeningTime</td>";
                  txt = txt + "<td class='cellborder cellleft'>UpdateTime</td>";
                  txt = txt + "<td class='cellborder cellleft'>TOver</td>";
                  txt = txt + "<td class='cellborder cellleft'>Win</td>";
                  txt = txt + "<td class='cellborder cellleft'>Lose</td>";
                  txt = txt + "<td class='cellborder cellleft'>Member W/L</td>";
                  txt = txt + "<td class='cellborder cellleft'>Pending</td>";
                  txt = txt + "</tr>";

                  var prevUser = "";
                  var prevABC = "";
                  var prevAB = "";

                  var rowspan = 1;

                  var UserRow = 0;
                  var ABRow = 0;
                  var ABCRow = 0;

                  var IsFirstTime = false;

                  for (let i = 0; i < myrows; i++) {
                    //---- at first time, first record ----------------------------------

                    if (i == 0) {
                      prevUser = mydata[i].UserName;
                      prevAB = mydata[i].AB;
                      prevABC = mydata[i].ABC;

                      UserRow = 0;
                      ABRow = 0;
                      ABCRow = 0;

                      IsFirstTime = true;
                    }

                    // alert(mydata[i].UserName + " ~vs~ " +  prevUser + " ~~ i: " + i);

                    if (i !=0 && mydata[i].UserName != prevUser) {
                      prevUser = mydata[i].UserName;
                      prevAB = mydata[i].AB;
                      prevABC = mydata[i].ABC;

                      UserRow = 0;
                      ABRow = 0;
                      ABCRow = 0;

                      IsFirstTime = true;
                    }



                    for (let t = 0; t < myrows; t++) {
                      if (SearchList[t].UserName == prevUser) {
                        UserRow++;
                      }

                      if (SearchList[t].AB == prevAB && SearchList[t].UserName == prevUser) {
                        ABRow++;
                      }

                      if (SearchList[t].ABC == prevABC && SearchList[t].AB == prevAB && SearchList[t].UserName == prevUser) {
                        ABCRow++;
                      }
                    }

                    if (UserRow > 1) {
                      UserRow = UserRow - 1;
                      ABRow = ABRow - 1;
                    }

                    if (prevUser == "DAIB_HHHAABL1GUE") {
                      // alert(i + " UserRow: " + UserRow);
                      // alert(i + " ABRow: " + ABRow);
                    }

                    var cellclass = "";
                    var otime = mydata[i].OpeningTime.toString().replaceAll("T", " ");
                    var utime = mydata[i].UpdateDate.toString().replaceAll("T", " ");

                    txt = txt + "<tr>";

                    var myi = i;
                    if (i % 2 != 0) {
                      cellclass = "cellgrey";
                    }
                    else {
                      cellclass = "";
                    }

                    UserRow = 1;
                    ABRow = 1;
                    ABCRow = 1;

                    //-------- first merged column on User Name ------------------------

                    if (IsFirstTime && mydata[i].UserName == prevUser) {
                      txt = txt + "<td valign='top' rowspan="+ UserRow + " class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span onclick='DrillByUserName(this)' class='bckPeal cellleft' data-UserName='" + mydata[i].UserName + "' data-BetType='" + BetType + "'>" + mydata[i].UserName + "</span></td>";
                      // IsFirstTime = false;
                    }
                    else {
                      txt = txt + "<td></td>";
                    }

                    // second merged field ----------------------------------
                    if (IsFirstTime && mydata[i].AB == prevAB && mydata[i].UserName == prevUser) {
                      txt = txt + "<td valign='top' rowspan=" + ABRow + " class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span class='cellleft'>" + mydata[i].BillNo + "</span></td>";
                      // IsFirstTime = false;
                    }
                    else {
                      txt = txt + "<td></td>";
                    }


                    // second merged field ----------------------------------
                    if (IsFirstTime && mydata[i].ABC == prevABC && mydata[i].AB == prevAB && mydata[i].UserName == prevUser) {
                      txt = txt + "<td valign='top' rowspan=" + ABCRow + " class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span class='cellleft'>" + otime + "</span></td>";
                    }
                    else {
                      txt = txt + "<td></td>";
                    }

                    
                    IsFirstTime = false;

                    
                    txt = txt + "<td class='celldata cellleft " + cellclass + "' style='max-width:120px;'><span class='cellleft'>" + utime + "</span></td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma( Number(mydata[i].TurnOver.toString()).toFixed(4) ) + "</td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalWin.toString()).toFixed(4)) + "</td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalLost.toString()).toFixed(4)) + "</td>";

                    if (Number(mydata[i].WL.toString()) < 0) {
                      txt = txt + "<td class='negativecell celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].WL.toString()).toFixed(4)) + "</td>";
                    }
                    else {
                      txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].WL.toString()).toFixed(4)) + "</td>";
                    }
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalPending.toString()).toFixed(4)) + "</td>";

                    txt = txt + "</tr>";
                    prevUser = "";

                    ttTOver = ttTOver + Number(mydata[i].TurnOver.toString());
                    ttTotalWin = ttTotalWin + Number(mydata[i].TotalWin.toString());
                    ttTotalLost = ttTotalLost + Number(mydata[i].TotalLost.toString());
                    ttPending = ttPending + Number(mydata[i].TotalPending.toString());
                    ttWL = ttWL + Number(mydata[i].WL.toString());


                    // ----- before looping back to next item --------
                    prevUser = mydata[i].UserName;
                    prevAB = mydata[i].AB;
                    prevABC = mydata[i].ABC;
                    // IsFirstTime = true;
                  }

                  //---- final summary line ---------------------------------------

                  if (myrows % 2 != 0) {
                    cellclass = "cellgrey";
                  }
                  else {
                    cellclass = "celldata";
                  }

                  txt = txt + "<tr>";
                  txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "' colspan=4><span style='font-weight:500;'>Total</span></td>";
                  txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttTOver.toFixed(4) ) + "</td>";
                  txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttTotalWin.toFixed(4)) + "</td>";
                  txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttTotalLost.toFixed(4)) + "</td>";

                  if (ttWL < 0) {
                    txt = txt + "<td class='sumcell cellborder cellleft negativecell " + cellclass + "'>" + formatcomma(ttWL.toFixed(4)) + "</td>";
                  }
                  else {
                    txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttWL.toFixed(4)) + "</td>";
                  }
                  txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "'>" + formatcomma(ttPending.toFixed(4)) + "</td>";
                  txt = txt + "</tr>";

                  document.getElementById("L2Area").innerHTML = txt1 + txt;

                  var copyrightleft = parseInt( window.innerWidth / 2) - 200;
                  document.getElementById("copyright2").style.left = copyrightleft + "px";
                  var hh = document.getElementById("L2Area").offsetHeight;
                  var tt = document.getElementById("L2Area").offsetTop;
                  var cpt = hh + tt + 5;

                  document.getElementById("copyright2").style.position = "absolute";
                  document.getElementById("copyright2").style.display = "block";
                  document.getElementById("copyright2").style.top = cpt + "px";

                  checkbrowser();

                  var closebuttleft = document.getElementById("L2Area").offsetLeft + document.getElementById("L2Area").offsetWidth + 5;

                  document.getElementById("closebutton2").style.left = closebuttleft + "px";
                  document.getElementById("copybutton2").style.left = closebuttleft + "px";
                  document.getElementById("copybutton2").style.left = closebuttleft + "px";
                  document.getElementById("printbutton2").style.left = closebuttleft + "px"; 
                  document.getElementById("excelbutton2").style.left = closebuttleft + "px";
                  document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
                  document.getElementById("prevbutton2").style.left = closebuttleft + "px";

                  document.getElementById("closebutton2").style.top = document.getElementById("L2Area").style.top + "px";
                  document.getElementById("copybutton2").style.top = document.getElementById("L2Area").style.top + 25 + "px";
                  document.getElementById("copybutton2").style.top = document.getElementById("L2Area").style.top + 50 + "px";
                  document.getElementById("printbutton2").style.top = document.getElementById("L2Area").style.top + 75 + "px";
                  document.getElementById("excelbutton2").style.top = document.getElementById("L2Area").style.top + 100 + "px";
                  document.getElementById("downloadbutton2").style.top = document.getElementById("L2Area").style.top + 125 + "px";
                  document.getElementById("prevbutton2").style.top = document.getElementById("L2Area").style.top + 150 + "px";

                  var hh = document.getElementById("L2Area").offsetHeight;
                  var tt = document.getElementById("L2Area").offsetTop;
                  var cpt = hh + tt + 5;

                  document.getElementById("copyright2").style.position = "absolute";
                  document.getElementById("copyright2").style.display = "block";
                  document.getElementById("copyright2").style.top = cpt + "px";

                  document.getElementById('prevbutton2').setAttribute("onclick", "showArea('L1')");

                  document.getElementById("excelbutton2").setAttribute("onclick", "GenOverall_Excel_L2()");
                  document.getElementById("HistoryL2HD").innerHTML = txt1 + txt;
                  document.getElementById("HistoryL2HD").style = "display: none;";
                  document.getElementById("jsondataL2").innerText = '{ "ReportTitle": "Win/Lose Report by Game - Drill Down on Bet Type: ' + BetType + ' (Level 2)", "Data" : ' + document.getElementById("jsondataL2").innerText + '}';
                  document.getElementById("HistoryL2").innerHTML = txt;
                  document.getElementById("HistoryL2").style = "display: none;";

                  const body = document.body;
                  const html = document.documentElement;
                  const height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);
                  console.log(document.getElementById("jsondataL2").innerText);

                  document.getElementById("copybutton2").setAttribute("onclick", "CopyToClipboard('L2Area')");
                  document.getElementById("printbutton2").setAttribute("onclick", "print('L2Area')");
              },
              failure: function (response) {
                  console.log("failure");
              },
              error: function (response, status) {
                  console.log("error");
              }
          });
      }
  </script>

  <script>
    function DrillByUserName(me) {
        document.getElementById("CheckingArea").style.display = "none";

        var txt = "<img src='http://103.209.157.30:5106/clock.gif' />";
        document.getElementById("L3Area").style.textAlign = "center";
        document.getElementById("L3Area").innerHTML = txt;

        document.getElementById("L1Area").style.display = "none";
        document.getElementById("L2Area").style.display = "none";
        document.getElementById("L3Area").style.display = "inline-block";
        document.getElementById("L4Area").style.display = "none";

        document.getElementById("downloadbutton2").style.display = "none";

        var BetType = $(me).attr("data-BetType");
        var UserName = $(me).attr("data-UserName");
        var StartDate = document.getElementById("dtDateS").value + " 00:00:00";
        var EndDate = document.getElementById("dtDateE").value + " 23:59:59";

        var CurrentPeriod = document.getElementById("selected_ticketx").value;

        if (CurrentPeriod != "") {
            GetCurrentPeriodDates(CurrentPeriod);
          }

        document.getElementById("selected_accountx").value = UserName;

        $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/API/GetOverallByUser",
            data: JSON.stringify({ "BetType": BetType, "UserName": UserName, "StartDate": StartDate, "EndDate": EndDate , "CurrentPeriod": CurrentPeriod}),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
                document.getElementById("L3Area").style.textAlign = "left";
                
                document.getElementById("jsondataL3").innerText = JSON.stringify(response);
                var mydata = JSON.parse(document.getElementById("jsondataL3").innerText);
                var myrows = mydata.length;

                var ttTOver = 0;
                var ttTotalWinLose = 0;

                var txt1 = "<span style='font-family: Helvetica;font-size: 12px;font-weight:bold;color:red;'>Drill Down on Bet Type: " + BetType + ", User Name: " + UserName + "</span><br>";
                var txt = "<table style='font-size:12px;'>";
                txt = txt + "<tr>";
                txt = txt + "<td class='cellborder cellleft'>BillNo</td>";
                txt = txt + "<td class='cellborder cellleft'>OpeningTime</td>";
                txt = txt + "<td class='cellborder cellleft'>TOver</td>";
                txt = txt + "<td class='cellborder cellleft'>WinLose</td>";
                txt = txt + "</tr>";

                for (let i = 0; i < myrows; i++) {
                    if (i % 2 != 0) {
                      cellclass = "cellgrey";
                    }
                    else {
                      cellclass = "";
                    }


                    txt = txt + "<tr>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'><span onclick='DrillByTicket(this)' class='bckPeal cellleft' data-BetType='" + BetType + "' data-TicketNo='" + mydata[i].TicketNo + "' data-UserName='" + UserName + "'>" + mydata[i].TicketNo + "</span></td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + mydata[i].OpeningTime + "</td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TurnOver.toString()).toFixed(4)) + "</td>";

                    if (Number(mydata[i].TotalWinLose.toString()) >= 0) {
                        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalWinLose.toString()).toFixed(4)) + "</td>";
                    }
                    else {
                        txt = txt + "<td class='negativecell celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].TotalWinLose.toString()).toFixed(4)) + "</td>";
                    }
                    txt = txt + "</tr>";

                    ttTOver = ttTOver + Number(mydata[i].TurnOver.toString());
                    ttTotalWinLose = ttTotalWinLose + Number(mydata[i].TotalWinLose.toString());
                }

                if (myrows % 2 != 0) {
                  cellclass = "cellgrey";
                }
                else {
                  cellclass = "celldata";
                }

                txt = txt + "<tr>";
                txt = txt + "<td class='cellborder cellleft sumcell " + cellclass + "'><span style='font-weight:500'>Total</span></td>";
                txt = txt + "<td class='cellborder cellleft sumcell " + cellclass + "'></td>";
                txt = txt + "<td class='cellborder cellleft sumcell " + cellclass + "'>" + formatcomma(ttTOver.toFixed(4)) + "</td>";
                if (ttTotalWinLose >= 0) {
                    txt = txt + "<td class='cellborder cellleft sumcell " + cellclass + "'>" + formatcomma(ttTotalWinLose.toFixed(4)) + "</td>";
                }
                else {
                    txt = txt + "<td class='negativecell cellborder cellleft sumcell " + cellclass + "'>" + formatcomma(ttTotalWinLose.toFixed(4)) + "</td>";
                }
                txt = txt + "</tr>";

                document.getElementById("L3Area").innerHTML = txt1 + txt;

                var copyrightleft = parseInt( window.innerWidth / 2) - 200;
                document.getElementById("copyright2").style.left = copyrightleft + "px";
                var hh = document.getElementById("L3Area").offsetHeight;
                var tt = document.getElementById("L3Area").offsetTop;
                var cpt = hh + tt + 5;

                document.getElementById("copyright2").style.position = "absolute";
                document.getElementById("copyright2").style.display = "block";
                document.getElementById("copyright2").style.top = cpt + "px";

                checkbrowser();

                checkbrowser();

                var closebuttleft = document.getElementById("L3Area").offsetLeft + document.getElementById("L3Area").offsetWidth + 5;

                document.getElementById("closebutton2").style.left = closebuttleft + "px";
                document.getElementById("copybutton2").style.left = closebuttleft + "px";
                document.getElementById("copybutton2").style.left = closebuttleft + "px";
                document.getElementById("printbutton2").style.left = closebuttleft + "px"; 
                document.getElementById("excelbutton2").style.left = closebuttleft + "px";
                document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
                document.getElementById("prevbutton2").style.left = closebuttleft + "px";

                document.getElementById("closebutton2").style.top = document.getElementById("L3Area").style.top + "px";
                document.getElementById("copybutton2").style.top = document.getElementById("L3Area").style.top + 25 + "px";
                document.getElementById("copybutton2").style.top = document.getElementById("L3Area").style.top + 50 + "px";
                document.getElementById("printbutton2").style.top = document.getElementById("L3Area").style.top + 75 + "px";
                document.getElementById("excelbutton2").style.top = document.getElementById("L3Area").style.top + 100 + "px";
                document.getElementById("downloadbutton2").style.top = document.getElementById("L3Area").style.top + 125 + "px";
                document.getElementById("prevbutton2").style.top = document.getElementById("L3Area").style.top + 150 + "px";

                var hh = document.getElementById("L3Area").offsetHeight;
                var tt = document.getElementById("L3Area").offsetTop;
                var cpt = hh + tt + 5;

                document.getElementById("copyright2").style.position = "absolute";
                document.getElementById("copyright2").style.display = "block";
                document.getElementById("copyright2").style.top = cpt + "px";

                document.getElementById('prevbutton2').setAttribute("onclick", "showArea('L2')");
                document.getElementById("excelbutton2").setAttribute("onclick", "GenOverall_Excel_L3()");
                document.getElementById("HistoryL3HD").innerHTML = txt1 + txt;
                document.getElementById("HistoryL3").innerHTML = txt;
                document.getElementById("HistoryL3HD").style.display = "none";
                document.getElementById("HistoryL3").style.display = "none";
                document.getElementById("jsondataL3").innerText = '{ "ReportTitle": "Win/Lose Report by Game - Drill Down on Bet Type: ' + BetType + ', User Name: ' + UserName + ' (Level 3)", "Data" : ' + document.getElementById("jsondataL3").innerText + '}';

                document.getElementById("copybutton2").setAttribute("onclick", "CopyToClipboard('L3Area')");
                document.getElementById("printbutton2").setAttribute("onclick", "print('L3Area')");
                
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });

        console.log("done");
    }
  </script>

  <script>
    function DrillByTicket(me) {
        document.getElementById("CheckingArea").style.display = "none";

        var txt = "<img src='http://103.209.157.30:5106/clock.gif' />";
        document.getElementById("L4Area").style.textAlign = "center";
        document.getElementById("L4Area").innerHTML = txt;

        document.getElementById("L1Area").style.display = "none";
        document.getElementById("L2Area").style.display = "none";
        document.getElementById("L3Area").style.display = "none";
        document.getElementById("L4Area").style.display = "inline-block";

        document.getElementById("downloadbutton2").style.display = "none";

        var StartDate = $("#dtDateS").val() + " 00:00:00";
        var EndDate = $("#dtDateE").val() + " 23:59:59";
        var SelectedUserName = $(me).attr("data-UserName");
        var TicketNo = $(me).attr("data-TicketNo");
        var BetType = $(me).attr("data-BetType");

        $("#selected_ticketx").val(TicketNo);

        var CurrentPeriod = document.getElementById("selected_ticketx").value;

        if (CurrentPeriod != "") {
          GetCurrentPeriodDates(CurrentPeriod);
        }

        $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/API/DrillOverall_Level4",
            data: JSON.stringify({ "TicketNo": TicketNo, "Account": SelectedUserName, "BetType": BetType, "StartDate": StartDate, "EndDate": EndDate ,"CurrentPeriod": CurrentPeriod}),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
                document.getElementById("L4Area").style.textAlign = "left";
                document.getElementById("jsondataL4").innerText = JSON.stringify(response);
                document.getElementById("ReportJSON").innerText = JSON.stringify(response);
                document.getElementById("ReportJSON").style = "display: none;";
                console.log(document.getElementById("ReportJSON").innerText);
                var mydata = JSON.parse(document.getElementById("ReportJSON").innerText);
                var rownum = mydata.length;

                var SearchList = [];
                for (let z = 0; z < rownum; z++){
                  let myobj = {
                    "BetType": mydata[z].BetType,
                    "BetTime": mydata[z].BetTime,
                    "Bet": mydata[z].Bet,
                    "BetAmount": mydata[z].BetAmount,
                    "WinLose": mydata[z].WinLose,
                  }
                  SearchList.push(myobj);
                }

                console.log("Total Rows in Report: " + rownum);
                
                var txt1 = "<span style='font-family: Helvetica;font-size: 12px;font-weight:bold;color:red;'>Drill Down on Bet Type: " + BetType + ", User Name: " + SelectedUserName + ", Ticket No: " + TicketNo  + "</span><br>";

                var txt = "<table style='font-size:12px;' cellpadding=0 cellspacing=0>";
                txt = txt + "<tr >";
                txt = txt + "<td class='cellborder'>Bet Type</td>";
                txt = txt + "<td class='cellborder'>Bet Time</td>";
                txt = txt + "<td class='cellborder'>Bet</td>";
                txt = txt + "<td class='cellborder cellleft' >BetAmount</td>";
                txt = txt + "<td class='cellborder cellleft' >Win/Loss</td>";
                txt = txt + "</tr>";

                var Total_Recs = 0;
                var Total_TOver = 0;
                var Total_BetAmount = 0;
                var Total_WinMoney = 0;
                var Total_Sum_winlose_AllLOST = 0;
                var Total_Sum_winlose_AllWIN_4d = 0;
                var Total_Sum_winlose_AllWIN_NOT4d = 0;
                var Total_Win_Lose = 0;

                var prevBetType = "";
                var rowspan = 0;
                for (i = 0; i < rownum; i++) {
                    if (i % 2 != 0) {
                      cellclass = "cellgrey";
                    }
                    else {
                      cellclass = "";
                    }

                    txt = txt + "<tr >";

                    if (prevBetType != mydata[i].BetType) {
                      prevBetType = mydata[i].BetType

                      rowspan = 0;
                      for (let x = 0; x < rownum; x++) {
                        if (SearchList[x].BetType == prevBetType) {
                          rowspan++;
                        }
                      }
                      txt = txt + "<td valign='top' rowspan=" + rowspan + " class='celldata cellleft " + cellclass + "'>" + mydata[i].BetType + "</td>";
                    }
                    // txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + mydata[i].BetType + "</td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + mydata[i].BetTime + "</td>";
                    var tempbet = mydata[i].Bet;
                    var newbet = tempbet.replaceAll("(", "[");
                    var newbet = newbet.replaceAll(")", "]");
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + newbet + "</td>";
                    txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].BetAmount).toFixed(4)) + "</td>";
                    if (Number(mydata[i].WinLose) > 0) {
                        txt = txt + "<td class='celldata cellleft " + cellclass + "'>" + formatcomma(Number(mydata[i].WinLose).toFixed(4)) + "</td>";
                    }
                    else {
                        txt = txt + "<td class='celldata cellleft negativecell " + cellclass + "'>" + formatcomma(Number(mydata[i].WinLose).toFixed(4)) + "</td>";
                    }
                    txt = txt + "</tr>";

                    Total_BetAmount = Total_BetAmount + Number(mydata[i].BetAmount.toString());
                    Total_Win_Lose = Total_Win_Lose + Number(mydata[i].WinLose.toString());
                }


                if (rownum % 2 != 0) {
                  cellclass = "cellgrey";
                }
                else {
                  cellclass = "celldata";
                }

                txt = txt + "<tr >";
                txt = txt + "<td class='sumcell cellborder " + cellclass + "'>Total</td>";
                txt = txt + "<td class='sumcell cellborder " + cellclass + "'></td>";
                txt = txt + "<td class='sumcell cellborder " + cellclass + "'></td>";
                txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "' >" + formatcomma(Total_BetAmount.toFixed(4)) + "</td>";
                if (Total_Win_Lose > 0) {
                    txt = txt + "<td class='sumcell cellborder cellleft " + cellclass + "' >" + formatcomma(Total_Win_Lose.toFixed(4)) + "</td>";
                }
                else {
                    txt = txt + "<td class='sumcell cellborder cellleft negativecell " + cellclass + "' >" + formatcomma(Total_Win_Lose.toFixed(4)) + "</td>";
                }
                txt = txt + "</tr>";


                txt = txt + "</table><br>";

                document.getElementById("L4Area").innerHTML = txt1 + txt;

                var copyrightleft = parseInt( window.innerWidth / 2) - 200;
                document.getElementById("copyright2").style.left = copyrightleft + "px";
                var hh = document.getElementById("L4Area").offsetHeight;
                var tt = document.getElementById("L4Area").offsetTop;
                var cpt = hh + tt + 5;

                document.getElementById("copyright2").style.position = "absolute";
                document.getElementById("copyright2").style.display = "block";
                document.getElementById("copyright2").style.top = cpt + "px";


                checkbrowser();

                var closebuttleft = document.getElementById("L4Area").offsetLeft + document.getElementById("L4Area").offsetWidth + 5;

                document.getElementById("closebutton2").style.left = closebuttleft + "px";
                document.getElementById("copybutton2").style.left = closebuttleft + "px";
                document.getElementById("copybutton2").style.left = closebuttleft + "px";
                document.getElementById("printbutton2").style.left = closebuttleft + "px"; 
                document.getElementById("excelbutton2").style.left = closebuttleft + "px";
                document.getElementById("downloadbutton2").style.left = closebuttleft + "px";
                document.getElementById("prevbutton2").style.left = closebuttleft + "px";

                document.getElementById("closebutton2").style.top = document.getElementById("L4Area").style.top + "px";
                document.getElementById("copybutton2").style.top = document.getElementById("L4Area").style.top + 25 + "px";
                document.getElementById("copybutton2").style.top = document.getElementById("L4Area").style.top + 50 + "px";
                document.getElementById("printbutton2").style.top = document.getElementById("L4Area").style.top + 75 + "px";
                document.getElementById("excelbutton2").style.top = document.getElementById("L4Area").style.top + 100 + "px";
                document.getElementById("downloadbutton2").style.top = document.getElementById("L4Area").style.top + 125 + "px";
                document.getElementById("prevbutton2").style.top = document.getElementById("L4Area").style.top + 150 + "px";

                var hh = document.getElementById("L4Area").offsetHeight;
                var tt = document.getElementById("L4Area").offsetTop;
                var cpt = hh + tt + 5;

                document.getElementById("copyright2").style.position = "absolute";
                document.getElementById("copyright2").style.display = "block";
                document.getElementById("copyright2").style.top = cpt + "px";
                
                document.getElementById('prevbutton2').setAttribute("onclick", "showArea('L3')");
                document.getElementById("excelbutton2").setAttribute("onclick", "GenOverall_Excel_L4()");

                document.getElementById("jsondataL4").innerText = '{ "ReportTitle": "Win/Lose Report by Game - Drill Down on Bet Type: ' + BetType + ', User Name: ' + SelectedUserName + ', Ticket No: ' + TicketNo + ' (Level 4)", "Data" : ' + document.getElementById("jsondataL4").innerText + '}';

                document.getElementById("copybutton2").setAttribute("onclick", "CopyToClipboard('L4Area')");
                document.getElementById("printbutton2").setAttribute("onclick", "print('L4Area')");
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });

        console.log("done");
    }
  </script>

  <script>
      function configureContentScrollbar() {
          document.getElementById("ReportContent").style = "display: block; text-align: center; overflow-y: scroll;scrollbar-color: pink lightblue;"
      }
  </script>

  <script>
    function formatcommadummy(mynum) {
      if (mynum == "null" || mynum == null) {
             alert("Null value found here!!!");
      }

      var numstr = mynum.toString();
      outstr = numstr;
      return outstr;
    }

  </script>

  <script>
      function padfront(_new, me) {
          var outstr = _new + me;
          return outstr;
      }
  </script>

  <script>
      function formatcomma(mynum) {
          if (mynum == "null" || mynum == null) {
             alert("Null value found here!!!");
          }

          var numstr = mynum.toString();

          var negfactor = -1;
          var isnegative = numstr.indexOf("-");
          if (isnegative == -1) {
              negfactor = 1;
          }
          numstr = numstr.replaceAll("-", "");

          var numlen = numstr.length;
          numstr = numstr.replaceAll(" ", "");
          var decimalpoint = numstr.indexOf(".");
          if (decimalpoint == -1) {
              numstr = numstr + ".00";
              decimalpoint = numstr.indexOf(".");
          }
          
          numlen = numstr.length;
          var newstr = "";
          var decstr = numstr.substr(decimalpoint, numlen);
          var intpart = numstr.substr(0, decimalpoint);

          var balstr = "";
          var outstr = "";
          var threelen = 0;
          var outstr = ""
          var tail = "";
          var head = "";
          var oritail = "";
          var ballen = 0;
          var headlen = 0;
          var demostr = "";

          oritail = tail;
          outstr = head + "--" + oritail;
          balstr = head;

          for (let i = 0; i < 20; i++) {
              if (decimalpoint == -1) {
                  oritail = numstr;
                  break;
              }
              else if (decimalpoint != -1 && intpart.length <= 3) {
                  oritail = numstr;
                  break;
              }
              else if (decimalpoint != -1 && intpart.length > 3) {
                  decimalpoint = numlen;
              }

              if (i == 0) {
                  head = intpart;
                  tail = decstr;
                  balstr = head;
                  oritail = numstr.substr(decimalpoint, numlen);
                  demostr = "[" + head + "][" + tail + "][" + oritail + "]"
                  ballen = balstr.length;
              }
              else if (i == 0 && numstr.length <= 3) {
                  oritail = intpart + decstr;
                  break;
              }

              else {
                  headlen = balstr.length - 3;
                  ballen = 3;
                  numlen = balstr.length;

                  if (headlen >= 3) {
                      head = balstr.substr(0, headlen);
                      tail = balstr.substr(headlen, numlen); // cheah modi here
                      oritail = padfront(",", tail) + oritail;
                      balstr = head;

                  }
                  else if (headlen < 3 && headlen != 0) {
                      head = balstr.substr(0, headlen);
                      tail = balstr.substr(headlen, numlen);
                      demostr = "[" + head + "][" + tail + "][" + oritail + "]"
                      oritail = head + padfront(",", tail) + oritail;
                      break;
                  }
                  else {
                      head = balstr.substr(0, headlen);
                      tail = balstr.substr(headlen, numlen);
                      demostr = "[" + head + "][" + tail + "][" + oritail + "]"
                      oritail = head + tail + oritail;
                      break;
                  }

              }

          }

          if (oritail.indexOf(".") != -1) {
              outstr = oritail;
          }
          else {
              outstr = oritail + decstr;
          }
          if (negfactor == -1) {
              outstr = "-" + outstr;
          }
          
          return outstr;
      }
  </script>

  <script>
    function showdate()
    {
    }
  </script>

  <script>
    function GetCurrentPeriodDates(cp) {

      if (cp != "") {
        $.ajax({
              type: "POST",
              url: "http://103.209.157.30:5106/API/GetCurrentPeriodDateRange",
              data: JSON.stringify({ "InputText" : cp}),
              contentType: "application/json; charset=utf-8",
              dataType: "json",
              crossDomain: true,
              success: function (response) {
                document.getElementById("dtDateS").value = response.StartDate;
                document.getElementById("dtDateE").value = response.EndDate;
              },
              failure: function (response) {
                  console.log("failure");
              },
              error: function (response, status) {
                  console.log("error");
              }
          });
      }
    }
  </script>

  <script>
    function showTime()
    {
        alert($('#appt-time').val() + " to " + $('#appt-time2').val());
    }
  </script>

  <script>
    function GetLotteryTypes(ds, de){
      // alert(ds + "\n" + de);
      $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/Bet/GetLotteryTypeSummaryLevel",
            data: JSON.stringify({ "dateStart": ds, "dateEnd": de }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              var maxcount = response.length;
              // alert("Success with: " + maxcount);

              for (let i = 0; i < response.length; i++) {
                var r = response[i];
                var robj = {};
                robj.LotteryTypeID = r.LotteryTypeID;
                robj.LotteryInfoID = 0;
                robj.LotteryTypeName = r.LotteryTypeName;
                robj.TOVer = 0;
                robj.Pending =  0;
                robj.AllLost =  0;
                robj.All4dWin =  0;
                robj.Allnon4dWin =  0;
                robj.WL =  0;
                robj.Agent_WL =  0;
                robj.Com_WL =  0;

                GetCalcFields(ds, de, r.LotteryTypeID, i, robj, maxcount);

              }

              console.log(document.getElementById("jsonLottery").innerText);
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
    }
  </script>

  <script>
    const objsLottery = [];

    function GetCalcFields(DateStart, DateEnd, LotteryTypeID, myidx, objList, max) {
      // alert(max);
      $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/Bet/GetCalculatedFields",
            data: JSON.stringify({ "dateStart": DateStart.toString(), "dateEnd": DateEnd.toString(), "LotteryTypeID": LotteryTypeID.toString() }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              objList.WL = response.WL;
              objList.TOVer = response.TOVer;
              objList.Pending =  response.Pending;
              objList.AllLost = response.AllLost;
              objList.All4dWin =  response.All4dWin;
              objList.Allnon4dWin = response.Allnon4dWin;
              objList.Agent_WL =  response.Agent_WL;
              objList.Com_WL =  response.Com_WL;      
              objsLottery.push(objList);
              document.getElementById("jsonLottery").innerText = JSON.stringify(objsLottery);
              // alert("Current Items: " + objsLottery.length);

              if (myidx == max - 1) {
                // alert("I am reaching the bottom");
                // alert(document.getElementById("jsonLottery").innerText);
                readList();
              }
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
      });

      
    }
  </script>

  <script>
    function GetMPlayerBetInfo(myid) {
      var mylid = myid;

      $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/Bet/GetMPlayerBetInfo",
            data: JSON.stringify({ "dateStart": mylid, "dateEnd": "" }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              return response;

            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
    }
  </script>

  <script>
    function GetBetTrans(myid) {
      var mylid = myid;
      var myname = "";
      var myticket = "";
      $.ajax({
            type: "POST",
            url: "http://103.209.157.30:5106/Bet/GetMPlayerBetInfo",
            data: JSON.stringify({ "dateStart": mylid, "dateEnd": "" }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            crossDomain: true,
            success: function (response) {
              myname = response.Username;
              myticket = response.Bill_No_Ticket;

              console.log("From Ajax: " + myname);
              var f1 = "_f1_" + myid + "";
              f1 = f1.replaceAll("'", "");
              console.log("My id: " + f1);
              document.getElementById(f1).innerHTML = myname;

              var f2 = "_f2_" + myid + "";
              f2 = f2.replaceAll("'", "");
              document.getElementById(f2).innerHTML = myticket;
            },
            failure: function (response) {
                console.log("failure");
            },
            error: function (response, status) {
                console.log("error");
            }
        });
    }
  </script>

  <script>
    function testClass() {
      // alert("testing class");
      var StartDate = document.getElementById("dtDateS").value;
      var EndDate = document.getElementById("dtDateE").value;

      var StartTime = $('#appt-time').val();
      var EndTime = $('#appt-time2').val();

      if (StartTime == "") {
        StartTime = "00:00:00";
      }

      if (EndTime == "") {
        EndTime = "23:59:59";
      }

      StartDate = StartDate + " " + StartTime;
      EndDate = EndDate + " " + EndTime;

      var ds = StartDate;
      var de = EndDate;

      // alert("Before I go: \n" + ds + "\n" + de);

      document.getElementById("L1Area").innerHTML = "<img src='http://103.209.157.30:5106/clock.gif' />";
      GetLotteryTypes(ds, de);

      console.log(document.getElementById("jsonLottery").innerText);
    }
  </script>

  <script>
    function readList(){
      checkbrowser();

      var mylist = JSON.parse(document.getElementById("jsonLottery").innerText);

      mylist.sort(function(c, d){
        
          let x = c.LotteryTypeName.toLowerCase();
          let y = d.LotteryTypeName.toLowerCase();
          if (x < y) {return -1;}
          if (x > y) {return 1;}

          return 0;
      });

      var txt = "<table >";
      txt = txt + "<tr>";
      txt = txt + "<td class='boldcell cellborder'>LotteryTypeName</td>" ;
      txt = txt + "<td class='boldcell cellborder'>TOver</td>" ;
      txt = txt + "<td class='boldcell cellborder'>Pending</td>" ;
      txt = txt + "<td class='boldcell cellborder'>Member W/L</td>" ;
      txt = txt + "<td class='boldcell cellborder'>Agent W/L</td>" ;
      txt = txt + "<td class='boldcell cellborder'>Company W/L</td>" ;
      txt = txt + "<td class='boldcell cellborder'>MA W/L</td>" ;
      txt = txt + "<td class='boldcell cellborder'>SM W/L</td>" ;
      txt = txt + "</tr>";

      var cellclass = "";

      var ttTOver = 0;
      var ttPending = 0;
      var ttWL = 0;
      var TotalAgentWL = 0;
      var TotalComWL = 0;
      var TotalWinLose = 0;

      for (let i = 0; i < mylist.length; i++) {
        if ((i + 1) % 2 != 0) {
          cellclass = "cellgrey";
        }
        else
        {
          cellclass = "";
        }

        var tis = mylist[i];
        txt = txt + "<tr>";
        // txt = txt + "<td>" + tis.LotteryTypeName + "</td>" ;
        txt = txt + "<td class='celldata " + cellclass + "'><span class='bckPeal cellleft' style='font-weight:bold;' onclick='DrillBetTypeV2(this)' data-LotteryTypeID='" + tis.LotteryTypeID + "' data-BetType='" + tis.LotteryTypeName + "'>" + tis.LotteryTypeName + "</span>";
        txt = txt + "<button onclick='GenOverall_Excel_L2_V3(this)' data-link='link_" + i + "' data-LotteryTypeID='" + tis.LotteryTypeID + "' data-BetType='" + tis.LotteryTypeName + "'>Excel</button>";
        txt = txt + "<a id='link_" + i + "' target='_blank' href='' style='display:none;'>Download</a></td>"
        txt = txt + "<td class='celldata " + cellclass + "'>" + formatcomma(Number(tis.TOVer).toFixed(2)) + "</td>" ;
        ttTOver = ttTOver + tis.TOVer;


        txt = txt + "<td class='celldata " + cellclass + "'>" + formatcomma(Number(tis.Pending).toFixed(2)) + "</td>" ;
        ttPending = ttPending + tis.Pending;


        if (Number(tis.WL).toFixed(2) < 0) {
          txt = txt + "<td class='celldata " + cellclass + " negativecell'>" + formatcomma(Number(tis.WL).toFixed(2)) + "</td>" ;  
        }
        else {
          txt = txt + "<td class='celldata " + cellclass + "'>" + formatcomma(Number(tis.WL).toFixed(2)) + "</td>" ;
        }
        ttWL = ttWL + tis.WL;

        if (Number(tis.Agent_WL).toFixed(2) < 0) {
          txt = txt + "<td class='celldata " + cellclass + " negativecell'>" + formatcomma(Number(tis.Agent_WL).toFixed(2)) + "</td>" ;  
        }
        else {
          txt = txt + "<td class='celldata " + cellclass + "'>" + formatcomma(Number(tis.Agent_WL).toFixed(2)) + "</td>" ;
        }
        TotalAgentWL = TotalAgentWL + tis.Agent_WL;

        if (Number(tis.Com_WL).toFixed(2) < 0) {
          txt = txt + "<td class='celldata " + cellclass + " negativecell'>" + formatcomma(Number(tis.Com_WL).toFixed(2)) + "</td>" ;  
        }
        else {
          txt = txt + "<td class='celldata " + cellclass + "'>" + formatcomma(Number(tis.Com_WL).toFixed(2)) + "</td>" ;
        }
        TotalComWL = TotalComWL + tis.Com_WL;
        
        txt = txt + "<td class='celldata " + cellclass + "'>" + formatcomma(Number("0.00").toFixed(2)) + "</td>" ;
        txt = txt + "<td class='celldata " + cellclass + "'>" + formatcomma(Number("0.00").toFixed(2)) + "</td>" ;
        txt = txt + "</tr>";
      }

      //----- displaying Total Line ----------------------------------------------
      if (mylist.length % 2 != 0) {
        cellclass = "cellgrey";
      }
      else {
        cellclass = "";
      }
      txt = txt + "<tr>";
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>Total:</td>" ;
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>" + formatcomma(Number(ttTOver).toFixed(2)) + "</td>" ;
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>" + formatcomma(Number(ttPending).toFixed(2)) + "</td>" ;
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>" + formatcomma(Number(ttWL).toFixed(2)) + "</td>" ;
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>" + formatcomma(Number(TotalAgentWL).toFixed(2)) + "</td>" ;
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>" + formatcomma(Number(TotalComWL).toFixed(2)) + "</td>" ;
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>" + formatcomma(Number("0.00").toFixed(2)) + "</td>" ;
      txt = txt + "<td class='boldcell sumcell " + cellclass + "'>" + formatcomma(Number("0.00").toFixed(2)) + "</td>" ;
      txt = txt + "</tr>";

      txt = txt + "</table>";

      // document.getElementById("jsonLottery").style = "display:none;";

      // alert(document.getElementById("jsonLottery").style);
      document.getElementById("L1Area").innerHTML = txt;
      checkbrowser();
      // alert(txt);
    }
  </script>

</head>
<body>
<div id="menuDiv" >
  <span>Test</span>
</div>

<div id="myButtons" onclick="hidemenu()">
  <span class="buttspan">BetHistory</span><div style="width:8px;display:inline-block;opacity: 0;"></div>
  <span class="buttspan">Win/Lost Report</span><div style="width:8px;display:inline-block;opacity: 0;"></div>
  <span class="buttspan activeButt">WinLostReportByGame</span><div style="width:8px;display:inline-block;opacity: 0;"></div>
  <span class="buttspan">OutstandingReport</span><div style="width:8px;display:inline-block;opacity: 0;"></div>
  <span class="buttspan">PragmaticPlaySlot Report</span><div style="width:8px;display:inline-block;opacity: 0;"></div>
  <span class="buttspan">ResetReport</span><div style="width:8px;display:inline-block;opacity: 0;"></div>
</div>

<div id="myDIVx" data-viewstate="small">
  Search Condition
</div>


<a id="burgerlink" class="burger"><img onclick="hidemenu()" id="burgerimg" class="burger" src="http://103.209.157.30:5106/cross.png"></a>
<div id="CheckingArea">.</div>
<div id="L1Area" class="container-fluid col-md-12 col-md-12"></div>
<div id="L2Area" class="container-fluid col-md-12 col-md-12"></div>
<div id="L3Area" class="container-fluid col-md-12 col-md-12"></div>
<div id="L4Area" class="container-fluid col-md-12 col-md-12"></div>

<button id="closebutton2" ><i class="fa fa-close"></i></button>
<button id="copybutton2" ><i class="fa fa-clone" style="font-size:15px"></i></button>
<button id="printbutton2" ><i class="fa fa-print" style="font-size:15px"></i></button>
<button id="excelbutton2" ><i class="fa fa-file-excel-o" style="font-size:15px;color:green;"></i></button>
<a id="downloadbutton2"><i class="fa fa-download" style="font-size:15px;color:red;"></i></i></a>
<button id="prevbutton2" ><i class="fa fa-mail-reply" style="font-size:15px;color:red"></i></i></button>
<!-- <button id="prevbutton2" ><i class="fa-solid fa-backward" style="font-size:15px;color:red"></i></button> -->
<div id="copyright2">
    <span>Copyright © 2019 Malaysia Golden Hippo In Tw Inc. All rights reserved</span>
</div>

<div id="HiddenInfo">
  <input type="text" id="browsertype" value="">
</div>

<div id="Report" style="display:none;"></div>
<div id="ReportJSON" style="display:none;"></div>
<div id="HistoryL1" style="display:none;"></div>
<div id="HistoryL1HD" style="display:none;"></div>
<div id="HistoryL2" style="display:none;"></div>
<div id="HistoryL2HD" style="display:none;"></div>
<div id="HistoryL3" style="display:none;"></div>
<div id="HistoryL3HD" style="display:none;"></div>

<div id="pop01" style="display:none;"></div>
<div id="div_result" style="display:none;"></div>
<div id="div_result_header" style="display:none;"></div>
<div id="curPeriods" style="display:none;"></div>
<div id="closebutt" style="display:none;"><button style="font-size:24px; float:right;" onclick="closePop()"><i class="fa fa-close"></i></button></div>
<div id="Report2" class="col-md-11 col-sm-11"></div>
<div id="pop02" style="display:none;"></div>
<div style="display: none;" id="closebutt2"></div>
<div id="reportHD"></div>
<div id="jsondata" style="display:none;"></div>
<div id="jsondataL2" style="display:none;"></div>
<div id="jsondataL3" style="display:none;"></div>
<div id="jsondataL4" style="display:none;"></div>
<div id="specialtitle"></div>

<div id="mySearchElements"  data-viewstate="small">
  <div style="display: inline-block;">
    <label class="mylabel">DateS</label><br>
    <input id="dtDateS" type="date" placeholder="" class="datebox curlyborder" onchange="showdate()"><div style="width:8px;display:inline-block;opacity: 0;"></div>
  </div>
  <div style="display: inline-block;">
    <label class="mylabel">DateE</label><br>
    <input id="dtDateE" type="date" placeholder=""  class="datebox curlyborder">
  </div>

  <div style="display: inline-block;">
    <a onclick="GenOverallReport()" id="btnOverall" style="opacity: 0;"><img style="opacity: 0;" src='http://103.209.157.30:5106/report.png' class="btnOverall"></a>
    <div style="width:10px;display:inline-block;opacity: 0;"></div>
  </div> 

  <div style="display: inline-block;">
    <span id="today" class="daterange" onclick="getToday()">Today</span><div style="width:3px;display:inline-block;opacity: 0;"></div>
    <span id="yesterday" class="daterange" onclick="getYesterday()">Yesterday</span><div style="width:3px;display:inline-block;opacity: 0;"></div>
    <span id="7days" class="daterange" onclick="get7Days()">Last 7 Days</span><div style="width:3px;display:inline-block;opacity: 0;"></div>
    <span id="14days" class="daterange" onclick="get14Days()">Last 14 Days</span><div style="width:3px;display:inline-block;opacity: 0;"></div>
  </div>

  <div id="ckydummy" style="width:50px;display:inline-block;opacity: 0;"></div>
  <div style="display: inline-block;">
    <label class="mylabel">Ticket</label><br>
    <input type="text" id="selected_ticketx">
    <div style="width:8px;display:inline-block;opacity: 0;"></div>
  </div>
  <div style="display: inline-block;">
    <label class="mylabel">Account</label><br>
    <input type="text" id="selected_accountx" >
    <div style="width:8px;display:inline-block;opacity: 0;"></div>
  </div>

  <div style="display: inline-block;">
    <label class="mylabel">Bet Type</label><br>
    <input type="text" id="selected_BetTypex" >
  </div>

  <div style="width:5px;display:inline-block;opacity: 0;"></div>
  <div style="display: inline-block;">
    <span class="daterange" onclick="clearTextbox()">Clear</span><div style="width:5px;display:inline-block;opacity: 0;"></div>
    <span class="searchButton" onclick="GenOverallReport()">Search</span><div style="width:5px;display:inline-block;opacity: 0;"></div>
  </div>
  <table cellpadding="0" cellspacing="0">
    <tr>
      <td>
        <input id="appt-time" type="time" name="appt-time" step="2" />
      </td>
      <td style="padding-left: 5px;padding-right: 5px;"></td>
      <td>
        <input id="appt-time2" type="time" name="appt-time2" step="2" />
      </td>
    </tr>
  </table>
</div>
<!-- <a id="downloadlink2" href="" target="_blank" style="display:none;" download>
    <img src="http://103.209.157.30:5106/red_download.jpg" style="width:30px;height:30px;border-style: solid; border-width: 1px; border-color:grey;">
</a>
 --><button id="prevbuttonL2" style="display: none; font-size:26px; float:right;" onclick="ShowPrevPageL2()"><img id='excelimg' src='http://103.209.157.30:5106/prev.png' style="width: 20px; height: 20px;" /></button>
<button id="prevbuttonL3" style="display: none; font-size:26px; float:right;" onclick="ShowPrevPageL3()"><img id='excelimg' src='http://103.209.157.30:5106/prev.png' style="width: 20px; height: 20px;" /></button>
<button id="prevbuttonL4" style="display: none; font-size:26px; float:right;" onclick="ShowPrevPageL4()"><img id='excelimg' src='http://103.209.157.30:5106/prev.png' style="width: 20px; height: 20px;" /></button>
<br />
<div id="ReportJSON2"></div>
<input type="text" id="TempPrice" value="" style='display:none;' /><input type="text" id="TempDiscPrice" value="" style='display:none;' /><input type="text" id="TempWinMoney" value="" style='display:none;' />

<div id="jsonLottery" style="display:none"></div>
</body>
</html>